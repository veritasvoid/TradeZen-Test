import{f as k,h as se,a as ae,b as le,d as $,r as g,j as e,e as re,X as y}from"./index-BphPB1Ha.js";import{a as ne,b as U,c as oe,d as R}from"./useTrades-71k3FSB_.js";import{u as de,a as S,g as O}from"./useTags-DrVJuJ_W.js";import{T as ie}from"./trash-2-CCIk-7r_.js";import{P as ce}from"./plus-CaUfIhTh.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=k("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=k("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=k("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=k("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=k("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Se=()=>{const{year:v,month:o}=se(),r=ae(),a=new Date,c=parseInt(v)||a.getFullYear(),t=o!==void 0?parseInt(o):a.getMonth(),{data:s=[],isLoading:h}=ne(c,t),{data:i=[]}=de();le();const d=$(l=>l.settings.currency),w=$(l=>l.settings.privacyMode),[m,n]=g.useState(null),[u,x]=g.useState(!1),[b,I]=g.useState(!1),[B,J]=g.useState(null),Y=["January","February","March","April","May","June","July","August","September","October","November","December"],H=new Date(c,t+1,0).getDate(),V=new Date(c,t,1).getDay(),D=s.reduce((l,p)=>l+p.amount,0),T=s.filter(l=>l.amount>0),_=s.filter(l=>l.amount<0),M=s.length>0?Math.round(T.length/s.length*100):0,L=ge(s),f={};s.forEach(l=>{const p=parseInt(l.date.split("-")[2]);f[p]||(f[p]=[]),f[p].push(l)});const[X,P]=g.useState(!1),[C,A]=g.useState(null),Z=l=>{A(l),P(!0)},z=l=>{n(l),x(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(re,{}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:[e.jsxs("div",{className:"max-w-[1800px] mx-auto p-[1.5vw] pt-20",children:[e.jsxs("div",{className:"flex items-center justify-center gap-[1vw] mb-[1.5vw]",children:[e.jsxs("button",{onClick:()=>{const l=t===0?11:t-1,p=t===0?c-1:c;r(`/month/${p}/${l}`)},className:"group flex items-center gap-[0.5vw] px-[1vw] py-[0.5vw] bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-[0.75vw] transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx(me,{size:20}),e.jsx("span",{className:"font-semibold",children:"Prev"})]}),e.jsxs("h1",{className:"text-[1.9vw] font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:[Y[t]," ",c]}),e.jsxs("button",{onClick:()=>{const l=t===11?0:t+1,p=t===11?c+1:c;r(`/month/${p}/${l}`)},className:"group flex items-center gap-[0.5vw] px-[1vw] py-[0.5vw] bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-[0.75vw] transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx("span",{className:"font-semibold",children:"Next"}),e.jsx(ue,{size:20})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-[1.5vw]",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-[1vw] border border-slate-700/50 p-[1.5vw]",children:[e.jsx("div",{className:"grid grid-cols-7 gap-[0.5vw] mb-[1vw]",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(l=>e.jsx("div",{className:"text-center text-slate-400 text-[0.85vw] font-semibold py-[0.5vw]",children:l},l))}),e.jsxs("div",{className:"grid grid-cols-7 gap-[0.5vw]",children:[Array.from({length:V}).map((l,p)=>e.jsx("div",{className:"aspect-square"},`empty-${p}`)),Array.from({length:H}).map((l,p)=>{const j=p+1,F=f[j]||[],G=F.reduce((ee,te)=>ee+te.amount,0),K=j===a.getDate()&&t===a.getMonth()&&c===a.getFullYear(),E=new Date(c,t,j).getDay(),Q=E===0||E===6;return e.jsx(xe,{day:j,trades:F,dayPL:G,isToday:K,isWeekend:Q,currency:d,privacyMode:w,onClick:()=>Z(j),onEditTrade:z},j)})]})]})}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-[1vw] border border-slate-700/50 p-[1.5vw]",children:[e.jsx("h3",{className:"text-[0.85vw] uppercase tracking-wider text-slate-400 mb-[1vw] font-semibold text-center",children:"Month Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{label:"Total P&L",value:S(D,d,w),color:D>=0?"emerald":"red"}),e.jsx(N,{label:"Trades",value:s.length}),e.jsx(N,{label:"Winners",value:T.length,color:"emerald"}),e.jsx(N,{label:"Losers",value:_.length,color:"red"}),e.jsx(N,{label:"Win Rate",value:`${M}%`,color:M>=50?"emerald":"red"})]})]}),L.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-[1vw] border border-slate-700/50 p-[1.5vw]",children:[e.jsx("h3",{className:"text-[0.85vw] uppercase tracking-wider text-slate-400 mb-[1vw] font-semibold text-center",children:"Strategies"}),e.jsx("div",{className:"space-y-3",children:L.map(l=>e.jsxs("div",{className:"bg-slate-800/50 rounded-[0.5vw] p-[0.75vw]",children:[e.jsxs("div",{className:"flex items-center gap-[0.5vw] mb-[0.5vw]",children:[e.jsx("span",{className:"text-[1.25vw]",children:l.tagEmoji}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-[0.65vw] font-bold truncate",style:{color:l.tagColor},children:l.tagName})})]}),e.jsx("div",{className:`text-[1.15vw] font-black ${l.totalPL>=0?"text-emerald-400":"text-red-400"}`,children:S(l.totalPL,d,w)}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-[0.25vw]",children:[l.trades,"T â€¢ ",l.winRate,"% WR"]})]},l.tagId))})]})]})]})]}),X&&C&&e.jsx(be,{day:C,year:c,month:t,trades:f[C]||[],tags:i,currency:d,privacyMode:w,onClose:()=>{P(!1),A(null)},onEditTrade:z}),u&&m&&e.jsx(we,{trade:m,tags:i,currency:d,onClose:()=>{x(!1),n(null)}}),b&&e.jsx(pe,{date:B,tags:i,currency:d,onClose:()=>{I(!1),J(null)}})]})]})},xe=({day:v,trades:o,dayPL:r,isToday:a,isWeekend:c,currency:t,privacyMode:s,onClick:h,onEditTrade:i})=>{const d=o.length>0,m=d?r>0?"bg-emerald-900/20 border-emerald-500/30":"bg-red-900/20 border-red-500/30":c?"bg-slate-800/20 border-slate-700/30":c?"":"bg-blue-950/20 border-blue-900/30";return e.jsxs("div",{onClick:h,className:`aspect-square rounded-[0.5vw] border ${m} ${a?"ring-2 ring-blue-500":""} p-[0.5vw] relative hover:bg-slate-700/30 transition-all cursor-pointer`,children:[e.jsx("div",{className:`text-[0.85vw] font-semibold ${c?"text-slate-300":"text-blue-400/60"}`,children:v}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-[1.15vw] font-black ${r>=0?"text-emerald-400":"text-red-400"}`,children:S(r,t,s)}),e.jsx("div",{className:"absolute bottom-1 left-1 grid grid-cols-2 gap-0.5 max-w-[70%]",children:[...new Set(o.map(n=>n.tagName).filter(Boolean))].slice(0,4).map(n=>e.jsx("span",{className:"text-[8px] text-slate-200 bg-slate-800/90 px-[0.25vw] py-0.5 rounded font-semibold truncate border border-slate-700/50 leading-none",children:n},n))}),[...new Set(o.map(n=>n.tagName).filter(Boolean))].length>4&&e.jsx("div",{className:"absolute bottom-1 left-1 translate-y-full mt-0.5",children:e.jsxs("span",{className:"text-[7px] text-slate-400",children:["+",[...new Set(o.map(n=>n.tagName).filter(Boolean))].length-4]})}),o.length>0&&e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg border border-slate-700",children:e.jsx("span",{className:"text-[9px] font-black text-white",children:o.length})}),e.jsx("div",{className:"absolute inset-0"})]})]})},be=({day:v,year:o,month:r,trades:a,tags:c,currency:t,privacyMode:s,onClose:h,onEditTrade:i})=>{const d=U(),[w,m]=g.useState(a.length===0),n=["January","February","March","April","May","June","July","August","September","October","November","December"],u=`${o}-${String(r+1).padStart(2,"0")}-${String(v).padStart(2,"0")}`,x=async b=>{if(confirm("Delete this trade?"))try{await d.mutateAsync(b)}catch(I){alert("Failed to delete: "+I.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-[1vw]",children:e.jsxs("div",{className:"bg-slate-900 rounded-[1vw] border border-slate-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto p-[1.5vw]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-[1.5vw] sticky top-0 bg-slate-900 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-[1.5vw] font-black",children:[n[r]," ",v,", ",o]}),e.jsxs("p",{className:"text-[0.85vw] text-slate-400",children:[a.length," trade",a.length!==1?"s":""]})]}),e.jsx("button",{onClick:h,className:"p-[0.5vw] hover:bg-slate-800 rounded-[0.5vw]",children:e.jsx(y,{size:20})})]}),a.length>0&&!w&&e.jsx("div",{className:"space-y-3 mb-[1.5vw]",children:a.map(b=>e.jsxs("div",{className:"bg-slate-800/50 rounded-[0.5vw] p-[1vw] flex items-center gap-[1vw]",children:[e.jsx("div",{className:"flex-shrink-0 text-[0.65vw] text-slate-500",children:b.time}),e.jsxs("div",{className:"flex-1",children:[b.tagName&&e.jsxs("div",{className:"flex items-center gap-[0.5vw] mb-[0.25vw]",children:[e.jsx("span",{className:"text-[0.85vw]",children:b.tagEmoji}),e.jsx("span",{className:"text-[0.65vw] font-semibold",style:{color:b.tagColor},children:b.tagName})]}),b.notes&&e.jsx("div",{className:"text-[0.65vw] text-slate-400",children:b.notes})]}),e.jsx("div",{className:`text-[1.25vw] font-black ${b.amount>=0?"text-emerald-400":"text-red-400"}`,children:S(b.amount,t,s)}),e.jsxs("div",{className:"flex gap-[0.5vw]",children:[e.jsx("button",{onClick:()=>{i(b),h()},className:"p-[0.5vw] bg-blue-600 hover:bg-blue-700 rounded-[0.5vw] transition-all",children:e.jsx(ve,{size:16})}),e.jsx("button",{onClick:()=>x(b.tradeId),className:"p-[0.5vw] bg-red-600 hover:bg-red-700 rounded-[0.5vw] transition-all",children:e.jsx(ie,{size:16})})]})]},b.tradeId))}),w?e.jsxs("div",{className:"border-t border-slate-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-[1vw]",children:[e.jsx("h4",{className:"font-bold",children:"New Trade"}),a.length>0&&e.jsx("button",{onClick:()=>m(!1),className:"text-[0.85vw] text-slate-400 hover:text-slate-300",children:"Cancel"})]}),e.jsx(he,{date:u,tags:c,currency:t,onSuccess:()=>{m(!1)}})]}):e.jsxs("button",{onClick:()=>m(!0),className:"w-full py-[0.75vw] bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-[0.5vw] transition-all font-semibold flex items-center justify-center gap-[0.5vw]",children:[e.jsx(ce,{size:20}),"Add Another Trade"]})]})})},he=({date:v,tags:o,currency:r,onSuccess:a})=>{const c=R(),[t,s]=g.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),[h,i]=g.useState(null),d=m=>{var u;const n=(u=m.target.files)==null?void 0:u[0];if(n){if(!n.type.startsWith("image/")){alert("Please select an image file");return}s({...t,screenshot:n}),i(URL.createObjectURL(n))}},w=async m=>{m.preventDefault();try{const n=o.find(u=>u.tagId===t.tagId);await c.mutateAsync({tradeId:O(),date:v,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(n==null?void 0:n.name)||null,tagColor:(n==null?void 0:n.color)||null,tagEmoji:(n==null?void 0:n.emoji)||null,notes:t.notes,screenshot:t.screenshot}),a(),s({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),i(null)}catch(n){alert("Failed to save: "+n.message)}};return e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-[0.75vw]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.65vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:m=>s({...t,time:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[0.75vw] py-[0.5vw] text-[0.85vw] focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[0.65vw] font-semibold text-slate-400 mb-[0.5vw]",children:["Amount (",r,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:m=>s({...t,amount:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[0.75vw] py-[0.5vw] text-[0.85vw] focus:border-blue-500 focus:outline-none",placeholder:"100",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.65vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Tag (Optional)"}),e.jsxs("select",{value:t.tagId,onChange:m=>s({...t,tagId:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[0.75vw] py-[0.5vw] text-[0.85vw] focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),o.map(m=>e.jsxs("option",{value:m.tagId,children:[m.emoji," ",m.name]},m.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.65vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Notes (Optional)"}),e.jsx("textarea",{value:t.notes,onChange:m=>s({...t,notes:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[0.75vw] py-[0.5vw] text-[0.85vw] focus:border-blue-500 focus:outline-none resize-none",rows:2,placeholder:"Trade notes..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.65vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Screenshot (Optional)"}),h?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full h-32 object-cover rounded-[0.5vw]"}),e.jsx("button",{type:"button",onClick:()=>{s({...t,screenshot:null}),i(null)},className:"absolute top-2 right-2 p-[0.25vw] bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(y,{size:16,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-[0.5vw]",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:d,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-[0.5vw] p-[1vw] text-center transition-all",children:[e.jsx(q,{size:24,className:"mx-auto mb-[0.25vw] text-slate-400"}),e.jsx("div",{className:"text-[0.65vw] text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:d,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-[0.5vw] p-[1vw] text-center transition-all",children:[e.jsx(W,{size:24,className:"mx-auto mb-[0.25vw] text-slate-400"}),e.jsx("div",{className:"text-[0.65vw] text-slate-400",children:"Upload"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:c.isLoading,className:"w-full py-[0.75vw] bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-[0.5vw] transition-all font-semibold disabled:opacity-50",children:c.isLoading?"Saving...":"Save Trade"})]})},we=({trade:v,tags:o,currency:r,onClose:a})=>{const c=oe(),t=U(),[s,h]=g.useState({amount:v.amount,time:v.time,tagId:v.tagId||"",notes:v.notes||"",screenshot:null}),[i,d]=g.useState(v.driveImageId?`https://drive.google.com/thumbnail?id=${v.driveImageId}&sz=w800`:null),w=u=>{var b;const x=(b=u.target.files)==null?void 0:b[0];if(x){if(!x.type.startsWith("image/")){alert("Please select an image file");return}h({...s,screenshot:x}),d(URL.createObjectURL(x))}},m=async u=>{u.preventDefault();try{const x=o.find(b=>b.tagId===s.tagId);await c.mutateAsync({tradeId:v.tradeId,updates:{...s,tagName:(x==null?void 0:x.name)||null,tagColor:(x==null?void 0:x.color)||null,tagEmoji:(x==null?void 0:x.emoji)||null}}),a()}catch(x){alert("Failed to update: "+x.message)}},n=async()=>{if(confirm("Delete this trade? This cannot be undone."))try{await t.mutateAsync(v.tradeId),a()}catch(u){alert("Failed to delete: "+u.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-[1vw]",children:e.jsxs("div",{className:"bg-slate-900 rounded-[1vw] border border-slate-700 max-w-md w-full p-[1.5vw] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-[1.5vw]",children:[e.jsx("h3",{className:"text-[1.5vw] font-black",children:"Edit Trade"}),e.jsx("button",{onClick:a,className:"p-[0.5vw] hover:bg-slate-800 rounded-[0.5vw]",children:e.jsx(y,{size:20})})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Date"}),e.jsx("input",{type:"text",value:v.date,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Time"}),e.jsx("input",{type:"time",value:s.time,onChange:u=>h({...s,time:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:["Amount (",r,")"]}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:u=>h({...s,amount:parseFloat(u.target.value)}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Tag"}),e.jsxs("select",{value:s.tagId,onChange:u=>h({...s,tagId:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),o.map(u=>e.jsxs("option",{value:u.tagId,children:[u.emoji," ",u.name]},u.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Notes"}),e.jsx("textarea",{value:s.notes,onChange:u=>h({...s,notes:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Screenshot"}),i?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:i,alt:"Trade screenshot",className:"w-full h-48 object-cover rounded-[0.5vw]"}),e.jsx("button",{type:"button",onClick:()=>{h({...s,screenshot:null}),d(null)},className:"absolute top-2 right-2 p-[0.5vw] bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(y,{size:20,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-[0.5vw]",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:w,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-[0.5vw] p-[1.5vw] text-center transition-all",children:[e.jsx(q,{size:28,className:"mx-auto mb-[0.5vw] text-slate-400"}),e.jsx("div",{className:"text-[0.65vw] text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-[0.5vw] p-[1.5vw] text-center transition-all",children:[e.jsx(W,{size:28,className:"mx-auto mb-[0.5vw] text-slate-400"}),e.jsx("div",{className:"text-[0.65vw] text-slate-400",children:"Upload"})]})]})]})]}),e.jsxs("div",{className:"flex gap-[0.75vw] pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-[1vw] py-[0.75vw] bg-red-600 hover:bg-red-700 rounded-[0.5vw] transition-all font-semibold",children:"Delete"}),e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-[1vw] py-[0.75vw] bg-slate-800 hover:bg-slate-700 rounded-[0.5vw] transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c.isLoading,className:"flex-1 px-[1vw] py-[0.75vw] bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-[0.5vw] transition-all font-semibold disabled:opacity-50",children:c.isLoading?"Saving...":"Save"})]})]})]})})},pe=({date:v,tags:o,currency:r,onClose:a})=>{const c=R(),[t,s]=g.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:""}),h=async i=>{i.preventDefault();try{const d=o.find(w=>w.tagId===t.tagId);await c.mutateAsync({tradeId:O(),date:v,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(d==null?void 0:d.name)||null,tagColor:(d==null?void 0:d.color)||null,tagEmoji:(d==null?void 0:d.emoji)||null,notes:t.notes,driveImageId:null}),a()}catch(d){alert("Failed to save: "+d.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-[1vw]",children:e.jsxs("div",{className:"bg-slate-900 rounded-[1vw] border border-slate-700 max-w-md w-full p-[1.5vw]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-[1.5vw]",children:[e.jsx("h3",{className:"text-[1.5vw] font-black",children:"New Trade"}),e.jsx("button",{onClick:a,className:"p-[0.5vw] hover:bg-slate-800 rounded-[0.5vw]",children:e.jsx(y,{size:20})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Date"}),e.jsx("input",{type:"text",value:v,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:i=>s({...t,time:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:["Amount (",r,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:i=>s({...t,amount:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none",placeholder:"e.g., 100 or -50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Tag"}),e.jsxs("select",{value:t.tagId,onChange:i=>s({...t,tagId:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),o.map(i=>e.jsxs("option",{value:i.tagId,children:[i.emoji," ",i.name]},i.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[0.85vw] font-semibold text-slate-400 mb-[0.5vw]",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:i=>s({...t,notes:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-[0.5vw] px-[1vw] py-[0.75vw] focus:border-blue-500 focus:outline-none resize-none",rows:3,placeholder:"Trade notes..."})]}),e.jsxs("div",{className:"flex gap-[0.75vw] pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-[1vw] py-[0.75vw] bg-slate-800 hover:bg-slate-700 rounded-[0.5vw] transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-[1vw] py-[0.75vw] bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-[0.5vw] transition-all font-semibold",children:"Save Trade"})]})]})]})})},N=({label:v,value:o,color:r})=>{const a=r==="emerald"?"text-emerald-400":r==="red"?"text-red-400":"text-white";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[0.65vw] text-slate-400 uppercase tracking-wider",children:v}),e.jsx("span",{className:`text-[1.15vw] font-black ${a}`,children:o})]})},ge=v=>{const o={};return v.forEach(r=>{const a=r.tagId||"none";a!=="none"&&(o[a]||(o[a]={tagId:a,tagName:r.tagName,tagColor:r.tagColor,tagEmoji:r.tagEmoji,totalPL:0,trades:0,wins:0}),o[a].totalPL+=r.amount,o[a].trades+=1,r.amount>0&&(o[a].wins+=1))}),Object.values(o).map(r=>({...r,winRate:r.trades>0?Math.round(r.wins/r.trades*100):0})).sort((r,a)=>a.totalPL-r.totalPL)};export{Se as default};
