import{c as A,h as ue,b as xe,d as be,e as V,r as j,j as e,f as he,X as I}from"./index-D0YVPx2p.js";import{a as ge,b as z,c as pe,d as G}from"./useTrades-D7h8Zo7c.js";import{u as fe,a as k,g as _}from"./useTags-C0CGZger.js";import{I as je,T as ve,S as Ne,C as F}from"./TagTradesModal-DfH3toa_.js";import{T as ye}from"./trash-2-gdABn-7E.js";import{P as we}from"./plus-DfbKwBYE.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=A("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ue=()=>{const{year:u,month:n}=ue(),o=xe(),l=new Date,c=parseInt(u)||l.getFullYear(),t=n!==void 0?parseInt(n):l.getMonth(),{data:a=[],isLoading:p}=ge(c,t),{data:m=[]}=fe(),x=z();be();const g=V(s=>s.settings.currency),d=V(s=>s.settings.privacyMode),[r,i]=j.useState(null),[b,v]=j.useState(!1),[h,y]=j.useState(!1),[X,K]=j.useState(null),P=["January","February","March","April","May","June","July","August","September","October","November","December"],Q=new Date(c,t+1,0).getDate(),Z=new Date(c,t,1).getDay(),L=a.reduce((s,f)=>s+f.amount,0),$=a.filter(s=>s.amount>0),ee=a.filter(s=>s.amount<0),E=a.length>0?Math.round($.length/a.length*100):0,U=Ae(a),w={};a.forEach(s=>{const f=parseInt(s.date.split("-")[2]);w[f]||(w[f]=[]),w[f].push(s)});const[te,R]=j.useState(!1),[T,O]=j.useState(null),[se,q]=j.useState(!1),[C,W]=j.useState(null),[ae,D]=j.useState(!1),[M,le]=j.useState(null),re=s=>{O(s),R(!0)},B=s=>{i(s),v(!0)},oe=s=>{W(s),q(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(he,{}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:[e.jsxs("div",{className:"max-w-[1800px] mx-auto p-6 pt-20",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>{const s=t===0?11:t-1,f=t===0?c-1:c;o(`/month/${f}/${s}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx(Se,{size:20}),e.jsx("span",{className:"font-semibold",children:"Prev"})]}),e.jsxs("h1",{className:"text-3xl font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:[P[t]," ",c]}),e.jsxs("button",{onClick:()=>{const s=t===11?0:t+1,f=t===11?c+1:c;o(`/month/${f}/${s}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx("span",{className:"font-semibold",children:"Next"}),e.jsx(Ie,{size:20})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsx("div",{className:"text-center text-slate-400 text-sm font-semibold py-2",children:s},s))}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:Z}).map((s,f)=>e.jsx("div",{className:"aspect-square"},`empty-${f}`)),Array.from({length:Q}).map((s,f)=>{const N=f+1,J=w[N]||[],ne=J.reduce((ce,me)=>ce+me.amount,0),de=N===l.getDate()&&t===l.getMonth()&&c===l.getFullYear(),Y=new Date(c,t,N).getDay(),ie=Y===0||Y===6;return e.jsx(ke,{day:N,trades:J,dayPL:ne,isToday:de,isWeekend:ie,currency:g,privacyMode:d,onClick:()=>re(N),onEditTrade:B},N)})]})]})}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Month Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{label:"Total P&L",value:k(L,g,d),color:L>=0?"emerald":"red"}),e.jsx(S,{label:"Trades",value:a.length}),e.jsx(S,{label:"Winners",value:$.length,color:"emerald"}),e.jsx(S,{label:"Losers",value:ee.length,color:"red"}),e.jsx(S,{label:"Win Rate",value:`${E}%`,color:E>=50?"emerald":"red"})]})]}),U.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Strategies"}),e.jsx("div",{className:"space-y-3",children:U.map(s=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:s.tagEmoji}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-xs font-bold truncate",style:{color:s.tagColor},children:s.tagName})})]}),e.jsx("div",{className:`text-lg font-black ${s.totalPL>=0?"text-emerald-400":"text-red-400"}`,children:k(s.totalPL,g,d)}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[s.trades,"T â€¢ ",s.winRate,"% WR"]})]},s.tagId))})]})]})]})]}),te&&T&&e.jsx(Te,{day:T,year:c,month:t,trades:w[T]||[],tags:m,currency:g,privacyMode:d,onClose:()=>{R(!1),O(null)},onEditTrade:B}),b&&r&&e.jsx(De,{trade:r,tags:m,currency:g,onClose:()=>{v(!1),i(null)}}),h&&e.jsx(Me,{date:X,tags:m,currency:g,onClose:()=>{y(!1),K(null)}}),se&&C&&e.jsx(je,{imageUrl:C.imageUrl,trade:C,currency:g,privacyMode:d,onClose:()=>{q(!1),W(null)}}),ae&&M&&e.jsx(ve,{tag:M,trades:a.filter(s=>s.tagId===M.tagId),scope:`${P[t]} ${c}`,currency:g,privacyMode:d,onClose:()=>{D(!1),le(null)},onEditTrade:s=>{i(s),v(!0),D(!1)},onDeleteTrade:async s=>{if(confirm("Delete this trade?"))try{await x.mutateAsync(s)}catch(f){alert("Failed to delete: "+f.message)}},onViewImage:s=>{const f=`https://drive.google.com/thumbnail?id=${s.driveImageId}&sz=w1200`;oe({...s,imageUrl:f}),D(!1)}})]})]})},ke=({day:u,trades:n,dayPL:o,isToday:l,isWeekend:c,currency:t,privacyMode:a,onClick:p,onEditTrade:m})=>{const x=n.length>0,d=x?o>0?"bg-emerald-900/20 border-emerald-500/30":"bg-red-900/20 border-red-500/30":c?"bg-slate-800/20 border-slate-700/30":c?"":"bg-blue-950/20 border-blue-900/30";return e.jsxs("div",{onClick:p,className:`aspect-square rounded-lg border ${d} ${l?"ring-2 ring-blue-500":""} p-2 relative hover:bg-slate-700/30 transition-all cursor-pointer`,children:[e.jsx("div",{className:`text-sm font-semibold ${c?"text-slate-300":"text-blue-400/60"}`,children:u}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-lg font-black ${o>=0?"text-emerald-400":"text-red-400"}`,children:k(o,t,a)}),e.jsx("div",{className:"absolute bottom-1 left-1 grid grid-cols-2 gap-0.5 max-w-[70%]",children:[...new Set(n.map(r=>r.tagName).filter(Boolean))].slice(0,4).map(r=>e.jsx("span",{className:"text-[8px] text-slate-200 bg-slate-800/90 px-1 py-0.5 rounded font-semibold truncate border border-slate-700/50 leading-none",children:r},r))}),[...new Set(n.map(r=>r.tagName).filter(Boolean))].length>4&&e.jsx("div",{className:"absolute bottom-1 left-1 translate-y-full mt-0.5",children:e.jsxs("span",{className:"text-[7px] text-slate-400",children:["+",[...new Set(n.map(r=>r.tagName).filter(Boolean))].length-4]})}),n.length>0&&e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg border border-slate-700",children:e.jsx("span",{className:"text-[9px] font-black text-white",children:n.length})}),e.jsx("div",{className:"absolute inset-0"})]})]})},Te=({day:u,year:n,month:o,trades:l,tags:c,currency:t,privacyMode:a,onClose:p,onEditTrade:m,onViewImage:x})=>{const g=z(),[d,r]=j.useState(l.length===0),i=["January","February","March","April","May","June","July","August","September","October","November","December"],b=`${n}-${String(o+1).padStart(2,"0")}-${String(u).padStart(2,"0")}`,v=async h=>{if(confirm("Delete this trade?"))try{await g.mutateAsync(h)}catch(y){alert("Failed to delete: "+y.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-slate-900 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-black",children:[i[o]," ",u,", ",n]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[l.length," trade",l.length!==1?"s":""]})]}),e.jsx("button",{onClick:p,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),l.length>0&&!d&&e.jsx("div",{className:"space-y-3 mb-6",children:l.map(h=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 text-xs text-slate-500",children:h.time}),e.jsxs("div",{className:"flex-1",children:[h.tagName&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:h.tagEmoji}),e.jsx("span",{className:"text-xs font-semibold",style:{color:h.tagColor},children:h.tagName})]}),h.notes&&e.jsx("div",{className:"text-xs text-slate-400",children:h.notes})]}),e.jsx("div",{className:`text-xl font-black ${h.amount>=0?"text-emerald-400":"text-red-400"}`,children:k(h.amount,t,a)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{m(h),p()},className:"p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>v(h.tradeId),className:"p-2 bg-red-600 hover:bg-red-700 rounded-lg transition-all",children:e.jsx(ye,{size:16})}),h.driveImageId&&e.jsx("button",{onClick:()=>{const y=`https://drive.google.com/thumbnail?id=${h.driveImageId}&sz=w1200`;x({...h,imageUrl:y})},className:"p-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-all",title:"View Screenshot",children:e.jsx(F,{size:16})})]})]},h.tradeId))}),d?e.jsxs("div",{className:"border-t border-slate-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-bold",children:"New Trade"}),l.length>0&&e.jsx("button",{onClick:()=>r(!1),className:"text-sm text-slate-400 hover:text-slate-300",children:"Cancel"})]}),e.jsx(Ce,{date:b,tags:c,currency:t,onSuccess:()=>{r(!1)}})]}):e.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold flex items-center justify-center gap-2",children:[e.jsx(we,{size:20}),"Add Another Trade"]})]})})},Ce=({date:u,tags:n,currency:o,onSuccess:l})=>{const c=G(),[t,a]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),[p,m]=j.useState(null),x=d=>{var i;const r=(i=d.target.files)==null?void 0:i[0];if(r){if(!r.type.startsWith("image/")){alert("Please select an image file");return}a({...t,screenshot:r}),m(URL.createObjectURL(r))}},g=async d=>{d.preventDefault();try{const r=n.find(i=>i.tagId===t.tagId);await c.mutateAsync({tradeId:_(),date:u,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(r==null?void 0:r.name)||null,tagColor:(r==null?void 0:r.color)||null,tagEmoji:(r==null?void 0:r.emoji)||null,notes:t.notes,screenshot:t.screenshot}),l(),a({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),m(null)}catch(r){alert("Failed to save: "+r.message)}};return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:d=>a({...t,time:d.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:d=>a({...t,amount:d.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",placeholder:"100",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Tag (Optional)"}),e.jsxs("select",{value:t.tagId,onChange:d=>a({...t,tagId:d.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),n.map(d=>e.jsxs("option",{value:d.tagId,children:[d.emoji," ",d.name]},d.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:t.notes,onChange:d=>a({...t,notes:d.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none resize-none",rows:2,placeholder:"Trade notes..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Screenshot (Optional)"}),p?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:p,alt:"Preview",className:"w-full h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{a({...t,screenshot:null}),m(null)},className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(I,{size:16,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:x,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all",children:[e.jsx(F,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:x,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all",children:[e.jsx(H,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:c.isLoading,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:c.isLoading?"Saving...":"Save Trade"})]})},De=({trade:u,tags:n,currency:o,onClose:l})=>{const c=pe(),t=z(),[a,p]=j.useState({amount:u.amount,time:u.time,tagId:u.tagId||"",notes:u.notes||"",screenshot:null}),[m,x]=j.useState(u.driveImageId?`https://drive.google.com/thumbnail?id=${u.driveImageId}&sz=w800`:null),g=i=>{var v;const b=(v=i.target.files)==null?void 0:v[0];if(b){if(!b.type.startsWith("image/")){alert("Please select an image file");return}p({...a,screenshot:b}),x(URL.createObjectURL(b))}},d=async i=>{i.preventDefault();try{const b=n.find(v=>v.tagId===a.tagId);await c.mutateAsync({tradeId:u.tradeId,updates:{...a,tagName:(b==null?void 0:b.name)||null,tagColor:(b==null?void 0:b.color)||null,tagEmoji:(b==null?void 0:b.emoji)||null}}),l()}catch(b){alert("Failed to update: "+b.message)}},r=async()=>{if(confirm("Delete this trade? This cannot be undone."))try{await t.mutateAsync(u.tradeId),l()}catch(i){alert("Failed to delete: "+i.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"Edit Trade"}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:u.date,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:a.time,onChange:i=>p({...a,time:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:i=>p({...a,amount:parseFloat(i.target.value)}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:a.tagId,onChange:i=>p({...a,tagId:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),n.map(i=>e.jsxs("option",{value:i.tagId,children:[i.emoji," ",i.name]},i.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:a.notes,onChange:i=>p({...a,notes:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Screenshot"}),m?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:m,alt:"Trade screenshot",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{p({...a,screenshot:null}),x(null)},className:"absolute top-2 right-2 p-2 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(I,{size:20,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:g,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all",children:[e.jsx(F,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all",children:[e.jsx(H,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-all font-semibold",children:"Delete"}),e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c.isLoading,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:c.isLoading?"Saving...":"Save"})]})]})]})})},Me=({date:u,tags:n,currency:o,onClose:l})=>{const c=G(),[t,a]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:""}),p=async m=>{m.preventDefault();try{const x=n.find(g=>g.tagId===t.tagId);await c.mutateAsync({tradeId:_(),date:u,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(x==null?void 0:x.name)||null,tagColor:(x==null?void 0:x.color)||null,tagEmoji:(x==null?void 0:x.emoji)||null,notes:t.notes,driveImageId:null}),l()}catch(x){alert("Failed to save: "+x.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"New Trade"}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:u,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:m=>a({...t,time:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:m=>a({...t,amount:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",placeholder:"e.g., 100 or -50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:t.tagId,onChange:m=>a({...t,tagId:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),n.map(m=>e.jsxs("option",{value:m.tagId,children:[m.emoji," ",m.name]},m.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:m=>a({...t,notes:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3,placeholder:"Trade notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold",children:"Save Trade"})]})]})]})})},S=({label:u,value:n,color:o})=>{const l=o==="emerald"?"text-emerald-400":o==="red"?"text-red-400":"text-white";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider",children:u}),e.jsx("span",{className:`text-lg font-black ${l}`,children:n})]})},Ae=u=>{const n={};return u.forEach(o=>{const l=o.tagId||"none";l!=="none"&&(n[l]||(n[l]={tagId:l,tagName:o.tagName,tagColor:o.tagColor,tagEmoji:o.tagEmoji,totalPL:0,trades:0,wins:0}),n[l].totalPL+=o.amount,n[l].trades+=1,o.amount>0&&(n[l].wins+=1))}),Object.values(n).map(o=>({...o,winRate:o.trades>0?Math.round(o.wins/o.trades*100):0})).sort((o,l)=>l.totalPL-o.totalPL)};export{Ue as default};
