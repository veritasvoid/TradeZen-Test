import{b as N,a as w,u as S,j as e,r as m,L as z,d as v,i as j,k as y}from"./index-Bdvvjnr-.js";import{L}from"./log-out-D54GgIJB.js";import{B as g}from"./Button-TfXIrqib.js";import{u as A,P as b,a as I,S as E,T as F,b as O,c as D,M as G}from"./useTags-DtCDwSS2.js";import{g as M}from"./utils-CGjH7Fn3.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=N("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=N("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),B=({title:s="TradeZen",showBack:o=!1,actions:l=null})=>{const t=w(),d=S(n=>n.signOut),c=()=>{confirm("Are you sure you want to sign out?")&&(d(),t("/"))};return e.jsx("header",{className:"sticky top-0 bg-background border-b border-border z-30",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-surface rounded-lg transition-colors",children:e.jsx(P,{size:20,className:"text-text-secondary"})}),e.jsx("h1",{className:"text-xl font-bold text-text-primary",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l,e.jsx("button",{onClick:c,className:"p-2 hover:bg-surface rounded-lg transition-colors",title:"Sign out",children:e.jsx(L,{size:20,className:"text-text-secondary"})})]})]})})},Y=()=>{const{data:s=[],isLoading:o}=A(),[l,t]=m.useState(!1),[d,c]=m.useState(null),n=()=>{c(null),t(!0)},r=i=>{c(i),t(!0)},x=()=>{t(!1),c(null)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Strategy Tags",actions:e.jsxs(g,{onClick:n,size:"sm",children:[e.jsx(b,{size:18,className:"mr-1"}),"New Tag"]})}),e.jsx("div",{className:"p-4 max-w-3xl mx-auto",children:o?e.jsx(z,{type:"skeleton-card"}):s.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ·ï¸"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"No strategy tags yet"}),e.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Create tags to categorize your trades by setup type"}),e.jsxs(g,{onClick:n,children:[e.jsx(b,{size:18,className:"mr-2"}),"Create Your First Tag"]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-text-tertiary text-sm",children:[s.length," tag",s.length!==1?"s":""]}),s.map(i=>e.jsx(R,{tag:i,onEdit:r},i.tagId))]})}),l&&e.jsx(V,{tag:d,existingTags:s,onClose:x})]})},R=({tag:s,onEdit:o})=>{var r;const{showToast:l}=v(),t=I(),[d,c]=m.useState(!1),n=async()=>{if(confirm(`Delete "${s.name}" tag?`))try{c(!0),await t.mutateAsync(s.tagId),l("Tag deleted","success")}catch{l("Failed to delete tag","error")}finally{c(!1)}};return e.jsx("div",{className:"card border-l-4 hover:bg-surface-hover transition-colors",style:{borderLeftColor:s.color},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"p-2 cursor-grab active:cursor-grabbing text-text-tertiary hover:text-text-secondary",children:e.jsx($,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-2xl",children:s.emoji}),e.jsx("span",{className:"text-lg font-semibold",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-sm text-text-tertiary",children:((r=j.find(x=>x.value===s.color))==null?void 0:r.name)||"Custom"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>o(s),className:"text-text-secondary hover:text-accent",children:e.jsx(E,{size:18})}),e.jsx(g,{variant:"ghost",size:"sm",onClick:n,loading:d,className:"text-text-secondary hover:text-loss",children:e.jsx(F,{size:18})})]})]})})},V=({tag:s,existingTags:o,onClose:l})=>{const{showToast:t}=v(),d=O(),c=D(),n=!!s,[r,x]=m.useState((s==null?void 0:s.name)||""),[i,T]=m.useState((s==null?void 0:s.emoji)||y[0]),[u,k]=m.useState((s==null?void 0:s.color)||j[0].value),[p,f]=m.useState(!1),C=async a=>{if(a.preventDefault(),!r.trim()){t("Please enter a tag name","error");return}if(o.find(h=>h.name.toLowerCase()===r.trim().toLowerCase()&&h.tagId!==(s==null?void 0:s.tagId))){t("A tag with this name already exists","error");return}try{if(f(!0),n)await c.mutateAsync({tagId:s.tagId,updates:{name:r.trim(),emoji:i,color:u}}),t("Tag updated","success");else{const h={tagId:M(),name:r.trim(),emoji:i,color:u,order:o.length};await d.mutateAsync(h),t("Tag created","success")}l()}catch(h){console.error("Failed to save tag:",h),t("Failed to save tag","error")}finally{f(!1)}};return e.jsx(G,{isOpen:!0,onClose:l,title:n?"Edit Tag":"Create Tag",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"card text-center py-6",style:{backgroundColor:`${u}20`,borderColor:u,borderWidth:"2px"},children:[e.jsx("div",{className:"text-4xl mb-2",children:i}),e.jsx("div",{className:"text-xl font-semibold",style:{color:u},children:r||"Tag Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tag Name"}),e.jsx("input",{type:"text",value:r,onChange:a=>x(a.target.value),className:"input",placeholder:"e.g., Break & Retest",maxLength:50,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Emoji"}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:y.map(a=>e.jsx("button",{type:"button",onClick:()=>T(a),className:`
                  text-2xl p-2 rounded-lg transition-colors
                  ${i===a?"bg-accent text-white":"bg-surface hover:bg-surface-hover"}
                `,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Color"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:j.map(a=>e.jsx("button",{type:"button",onClick:()=>k(a.value),className:`
                  p-3 rounded-lg transition-all
                  ${u===a.value?"ring-2 ring-offset-2 ring-accent scale-105":"hover:scale-105"}
                `,style:{backgroundColor:a.value},children:e.jsx("div",{className:"text-white text-xs font-medium",children:a.name})},a.value))})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(g,{type:"button",variant:"secondary",onClick:l,className:"flex-1",disabled:p,children:"Cancel"}),e.jsx(g,{type:"submit",className:"flex-1",loading:p,children:n?"Update Tag":"Create Tag"})]})]})})};export{Y as default};
