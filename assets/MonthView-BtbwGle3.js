import{c as oe,j as c,r as ge,X as Pt,d as Vt,R as z,e as dt,Q as sr,f as nr,b as ar,L as ir}from"./index-BNSpLmE2.js";import{t as B,s as ft,m as or,a as Et,b as cr,d as $e,e as lr,g as ur,h as dr,i as fr,j as hr,k as mr,f as Ct,l as ht,n as yr}from"./useTrades-CYUzA0xW.js";import{u as gr}from"./useTags-C_FI7zRI.js";import{H as mt}from"./Header-DKU8ttsi.js";import{B as we}from"./Button-BkT84Z7L.js";import{u as Qe}from"./settingsStore-BoRpuOJu.js";import"./useQuery-BesbtNAO.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=oe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=oe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=oe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=oe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=oe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function ie(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function At(e,t){const r=B(e);if(isNaN(t))return ie(e,NaN);if(!t)return r;const s=r.getDate(),n=ie(e,r.getTime());n.setMonth(r.getMonth()+t+1,0);const i=n.getDate();return s>=i?n:(r.setFullYear(n.getFullYear(),n.getMonth(),s),r)}let Nr={};function Ce(){return Nr}function Se(e,t){var d,v,k,_;const r=Ce(),s=(t==null?void 0:t.weekStartsOn)??((v=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:v.weekStartsOn)??r.weekStartsOn??((_=(k=r.locale)==null?void 0:k.options)==null?void 0:_.weekStartsOn)??0,n=B(e),i=n.getDay(),l=(i<s?7:0)+i-s;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function Pe(e){return Se(e,{weekStartsOn:1})}function Wt(e){const t=B(e),r=t.getFullYear(),s=ie(e,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const n=Pe(s),i=ie(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const l=Pe(i);return t.getTime()>=n.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function yt(e){const t=B(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Fr(e,t){const r=ft(e),s=ft(t),n=+r-yt(r),i=+s-yt(s);return Math.round((n-i)/or)}function Sr(e){const t=Wt(e),r=ie(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Pe(r)}function Tr(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Or(e){if(!Tr(e)&&typeof e!="number")return!1;const t=B(e);return!isNaN(Number(t))}function _r(e){const t=B(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Pr(e,t){const r=B(e.start),s=B(e.end);let n=+r>+s;const i=n?+r:+s,l=n?s:r;l.setHours(0,0,0,0);let d=1;const v=[];for(;+l<=i;)v.push(B(l)),l.setDate(l.getDate()+d),l.setHours(0,0,0,0);return n?v.reverse():v}function Vr(e){const t=B(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Er(e){const t=B(e),r=ie(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Cr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ar=(e,t,r)=>{let s;const n=Cr[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function qe(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Wr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ir={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Lr={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Yr={date:qe({formats:Wr,defaultWidth:"full"}),time:qe({formats:Ir,defaultWidth:"full"}),dateTime:qe({formats:Lr,defaultWidth:"full"})},Rr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},qr=(e,t,r,s)=>Rr[e];function je(e){return(t,r)=>{const s=r!=null&&r.context?String(r.context):"standalone";let n;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=r!=null&&r.width?String(r.width):l;n=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[d]||e.values[l]}const i=e.argumentCallback?e.argumentCallback(t):t;return n[i]}}const Ur={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Br={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Hr={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},$r={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Qr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Xr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zr=(e,t)=>{const r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Gr={ordinalNumber:zr,era:je({values:Ur,defaultWidth:"wide"}),quarter:je({values:Br,defaultWidth:"wide",argumentCallback:e=>e-1}),month:je({values:Hr,defaultWidth:"wide"}),day:je({values:$r,defaultWidth:"wide"}),dayPeriod:je({values:Qr,defaultWidth:"wide",formattingValues:Xr,defaultFormattingWidth:"wide"})};function De(e){return(t,r={})=>{const s=r.width,n=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(n);if(!i)return null;const l=i[0],d=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],v=Array.isArray(d)?Kr(d,p=>p.test(l)):Jr(d,p=>p.test(l));let k;k=e.valueCallback?e.valueCallback(v):v,k=r.valueCallback?r.valueCallback(k):k;const _=t.slice(l.length);return{value:k,rest:_}}}function Jr(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Kr(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Zr(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const n=s[0],i=t.match(e.parsePattern);if(!i)return null;let l=e.valueCallback?e.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const d=t.slice(n.length);return{value:l,rest:d}}}const es=/^(\d+)(th|st|nd|rd)?/i,ts=/\d+/i,rs={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ss={any:[/^b/i,/^(a|c)/i]},ns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},as={any:[/1/i,/2/i,/3/i,/4/i]},is={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},os={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},cs={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ls={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},us={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ds={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},fs={ordinalNumber:Zr({matchPattern:es,parsePattern:ts,valueCallback:e=>parseInt(e,10)}),era:De({matchPatterns:rs,defaultMatchWidth:"wide",parsePatterns:ss,defaultParseWidth:"any"}),quarter:De({matchPatterns:ns,defaultMatchWidth:"wide",parsePatterns:as,defaultParseWidth:"any",valueCallback:e=>e+1}),month:De({matchPatterns:is,defaultMatchWidth:"wide",parsePatterns:os,defaultParseWidth:"any"}),day:De({matchPatterns:cs,defaultMatchWidth:"wide",parsePatterns:ls,defaultParseWidth:"any"}),dayPeriod:De({matchPatterns:us,defaultMatchWidth:"any",parsePatterns:ds,defaultParseWidth:"any"})},hs={code:"en-US",formatDistance:Ar,formatLong:Yr,formatRelative:qr,localize:Gr,match:fs,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ms(e){const t=B(e);return Fr(t,Er(t))+1}function ys(e){const t=B(e),r=+Pe(t)-+Sr(t);return Math.round(r/Et)+1}function It(e,t){var _,p,S,w;const r=B(e),s=r.getFullYear(),n=Ce(),i=(t==null?void 0:t.firstWeekContainsDate)??((p=(_=t==null?void 0:t.locale)==null?void 0:_.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((w=(S=n.locale)==null?void 0:S.options)==null?void 0:w.firstWeekContainsDate)??1,l=ie(e,0);l.setFullYear(s+1,0,i),l.setHours(0,0,0,0);const d=Se(l,t),v=ie(e,0);v.setFullYear(s,0,i),v.setHours(0,0,0,0);const k=Se(v,t);return r.getTime()>=d.getTime()?s+1:r.getTime()>=k.getTime()?s:s-1}function gs(e,t){var d,v,k,_;const r=Ce(),s=(t==null?void 0:t.firstWeekContainsDate)??((v=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:v.firstWeekContainsDate)??r.firstWeekContainsDate??((_=(k=r.locale)==null?void 0:k.options)==null?void 0:_.firstWeekContainsDate)??1,n=It(e,t),i=ie(e,0);return i.setFullYear(n,0,s),i.setHours(0,0,0,0),Se(i,t)}function xs(e,t){const r=B(e),s=+Se(r,t)-+gs(r,t);return Math.round(s/Et)+1}function O(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}const ue={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return O(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):O(r+1,2)},d(e,t){return O(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return O(e.getHours()%12||12,t.length)},H(e,t){return O(e.getHours(),t.length)},m(e,t){return O(e.getMinutes(),t.length)},s(e,t){return O(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),n=Math.trunc(s*Math.pow(10,r-3));return O(n,t.length)}},xe={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},gt={G:function(e,t,r){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const s=e.getFullYear(),n=s>0?s:1-s;return r.ordinalNumber(n,{unit:"year"})}return ue.y(e,t)},Y:function(e,t,r,s){const n=It(e,s),i=n>0?n:1-n;if(t==="YY"){const l=i%100;return O(l,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):O(i,t.length)},R:function(e,t){const r=Wt(e);return O(r,t.length)},u:function(e,t){const r=e.getFullYear();return O(r,t.length)},Q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return O(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return O(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){const s=e.getMonth();switch(t){case"M":case"MM":return ue.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return O(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){const n=xs(e,s);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):O(n,t.length)},I:function(e,t,r){const s=ys(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):O(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ue.d(e,t)},D:function(e,t,r){const s=ms(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):O(s,t.length)},E:function(e,t,r){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){const n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return O(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){const n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return O(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const s=e.getDay(),n=s===0?7:s;switch(t){case"i":return String(n);case"ii":return O(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const s=e.getHours();let n;switch(s===12?n=xe.noon:s===0?n=xe.midnight:n=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const s=e.getHours();let n;switch(s>=17?n=xe.evening:s>=12?n=xe.afternoon:s>=4?n=xe.morning:n=xe.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return ue.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ue.H(e,t)},K:function(e,t,r){const s=e.getHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):O(s,t.length)},k:function(e,t,r){let s=e.getHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):O(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ue.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ue.s(e,t)},S:function(e,t){return ue.S(e,t)},X:function(e,t,r){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return bt(s);case"XXXX":case"XX":return he(s);case"XXXXX":case"XXX":default:return he(s,":")}},x:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"x":return bt(s);case"xxxx":case"xx":return he(s);case"xxxxx":case"xxx":default:return he(s,":")}},O:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+xt(s,":");case"OOOO":default:return"GMT"+he(s,":")}},z:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+xt(s,":");case"zzzz":default:return"GMT"+he(s,":")}},t:function(e,t,r){const s=Math.trunc(e.getTime()/1e3);return O(s,t.length)},T:function(e,t,r){const s=e.getTime();return O(s,t.length)}};function xt(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),n=Math.trunc(s/60),i=s%60;return i===0?r+String(n):r+String(n)+t+O(i,2)}function bt(e,t){return e%60===0?(e>0?"-":"+")+O(Math.abs(e)/60,2):he(e,t)}function he(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),n=O(Math.trunc(s/60),2),i=O(s%60,2);return r+n+t+i}const vt=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Lt=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},bs=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],s=r[1],n=r[2];if(!n)return vt(e,t);let i;switch(s){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",vt(s,t)).replace("{{time}}",Lt(n,t))},vs={p:Lt,P:bs},ws=/^D+$/,ps=/^Y+$/,ks=["D","DD","YY","YYYY"];function js(e){return ws.test(e)}function Ds(e){return ps.test(e)}function Ms(e,t,r){const s=Ns(e,t,r);if(console.warn(s),ks.includes(e))throw new RangeError(s)}function Ns(e,t,r){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Fs=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ss=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ts=/^'([^]*?)'?$/,Os=/''/g,_s=/[a-zA-Z]/;function me(e,t,r){var _,p,S,w;const s=Ce(),n=s.locale??hs,i=s.firstWeekContainsDate??((p=(_=s.locale)==null?void 0:_.options)==null?void 0:p.firstWeekContainsDate)??1,l=s.weekStartsOn??((w=(S=s.locale)==null?void 0:S.options)==null?void 0:w.weekStartsOn)??0,d=B(e);if(!Or(d))throw new RangeError("Invalid time value");let v=t.match(Ss).map(N=>{const M=N[0];if(M==="p"||M==="P"){const R=vs[M];return R(N,n.formatLong)}return N}).join("").match(Fs).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const M=N[0];if(M==="'")return{isToken:!1,value:Ps(N)};if(gt[M])return{isToken:!0,value:N};if(M.match(_s))throw new RangeError("Format string contains an unescaped latin alphabet character `"+M+"`");return{isToken:!1,value:N}});n.localize.preprocessor&&(v=n.localize.preprocessor(d,v));const k={firstWeekContainsDate:i,weekStartsOn:l,locale:n};return v.map(N=>{if(!N.isToken)return N.value;const M=N.value;(Ds(M)||js(M))&&Ms(M,t,String(e));const R=gt[M[0]];return R(d,M,n.localize,k)}).join("")}function Ps(e){const t=e.match(Ts);return t?t[1].replace(Os,"'"):e}function Vs(e){return B(e).getDay()}function Es(e,t){return At(e,-1)}const Cs=({onClick:e,icon:t=pr,label:r="Add"})=>c.jsx("button",{onClick:e,className:"fixed bottom-6 right-6 z-30 w-14 h-14 bg-accent hover:bg-accent-hover text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center active:scale-95","aria-label":r,children:c.jsx(t,{size:24})}),Xe=({isOpen:e,onClose:t,title:r,children:s,showCloseButton:n=!0,size:i="md"})=>{if(ge.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),!e)return null;const l=v=>{v.target===v.currentTarget&&t()},d={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",full:"max-w-6xl"};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"modal-backdrop animate-fade-in",onClick:l}),c.jsxs("div",{className:`modal-content ${d[i]} w-full`,children:[(r||n)&&c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[r&&c.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:r}),n&&c.jsx("button",{onClick:t,className:"p-2 hover:bg-surface-hover rounded-lg transition-colors",children:c.jsx(Pt,{size:20,className:"text-text-secondary"})})]}),c.jsx("div",{className:"p-6",children:s})]})]})},As=({date:e,trades:t,onClose:r,onAddTrade:s})=>{const{showToast:n}=Vt(),i=cr(),l=Qe(k=>k.settings.currency),d=t.reduce((k,_)=>k+_.amount,0),v=async k=>{if(confirm("Delete this trade?"))try{await i.mutateAsync(k),n("Trade deleted","success")}catch{n("Failed to delete trade","error")}};return c.jsx(Xe,{isOpen:!0,onClose:r,title:c.jsxs("div",{children:[c.jsx("div",{className:"text-xl font-bold",children:me(new Date(e),"EEEE, MMMM d, yyyy")}),c.jsx("div",{className:`text-2xl font-bold mt-1 ${d>=0?"text-profit":"text-loss"}`,children:$e(d,l)}),c.jsxs("div",{className:"text-sm text-text-secondary mt-1",children:[t.length," trade",t.length!==1?"s":""]})]}),children:c.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:t.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("p",{className:"text-text-secondary mb-4",children:"No trades on this day"}),c.jsx(we,{onClick:s,children:"Add Trade"})]}):c.jsxs(c.Fragment,{children:[t.map(k=>c.jsx(Ws,{trade:k,currency:l,onDelete:v},k.tradeId)),c.jsx(we,{onClick:s,variant:"secondary",className:"w-full",children:"+ Add Another Trade"})]})})})},Ws=({trade:e,currency:t,onDelete:r})=>{const[s,n]=z.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"card border-l-4",style:{borderLeftColor:e.tagColor},children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:`text-2xl font-bold mb-1 ${e.amount>=0?"text-profit":"text-loss"}`,children:$e(e.amount,t)}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-xl",children:e.tagEmoji}),c.jsx("span",{className:"text-sm font-medium",style:{color:e.tagColor},children:e.tagName})]})]}),c.jsx("div",{className:"text-sm text-text-tertiary",children:e.time})]}),e.driveImageId&&c.jsxs("button",{onClick:()=>n(!0),className:"w-full h-32 rounded-lg overflow-hidden bg-surface-hover mb-2 relative group",children:[c.jsx("img",{src:dt.getImageUrl(e.driveImageId),alt:"Trade screenshot",className:"w-full h-full object-cover"}),c.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:c.jsx(Mr,{size:32,className:"text-white"})})]}),e.notes&&c.jsx("p",{className:"text-sm text-text-secondary mb-3 p-2 bg-surface rounded",children:e.notes}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(we,{variant:"ghost",size:"sm",className:"flex-1 text-text-secondary hover:text-accent",children:[c.jsx(kr,{size:16,className:"mr-1"}),"Edit"]}),c.jsxs(we,{variant:"ghost",size:"sm",onClick:()=>r(e.tradeId),className:"flex-1 text-text-secondary hover:text-loss",children:[c.jsx(jr,{size:16,className:"mr-1"}),"Delete"]})]})]}),s&&c.jsx(Xe,{isOpen:!0,onClose:()=>n(!1),size:"lg",children:c.jsx("img",{src:dt.getImageUrl(e.driveImageId),alt:"Trade screenshot",className:"w-full h-auto rounded-lg"})})]})};var Te=e=>e.type==="checkbox",ye=e=>e instanceof Date,G=e=>e==null;const Yt=e=>typeof e=="object";var I=e=>!G(e)&&!Array.isArray(e)&&Yt(e)&&!ye(e),Is=e=>I(e)&&e.target?Te(e.target)?e.target.checked:e.target.value:e,Ls=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Ys=(e,t)=>e.has(Ls(t)),Rs=e=>{const t=e.constructor&&e.constructor.prototype;return I(t)&&t.hasOwnProperty("isPrototypeOf")},ze=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Y(e){if(e instanceof Date)return new Date(e);const t=typeof FileList<"u"&&e instanceof FileList;if(ze&&(e instanceof Blob||t))return e;const r=Array.isArray(e);if(!r&&!(I(e)&&Rs(e)))return e;const s=r?[]:Object.create(Object.getPrototypeOf(e));for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(s[n]=Y(e[n]));return s}var Ae=e=>/^\w*$/.test(e),A=e=>e===void 0,Ge=e=>Array.isArray(e)?e.filter(Boolean):[],Je=e=>Ge(e.replace(/["|']|\]/g,"").split(/\.|\[/)),y=(e,t,r)=>{if(!t||!I(e))return r;const s=(Ae(t)?[t]:Je(t)).reduce((n,i)=>G(n)?n:n[i],e);return A(s)||s===e?A(e[t])?r:e[t]:s},se=e=>typeof e=="boolean",Z=e=>typeof e=="function",E=(e,t,r)=>{let s=-1;const n=Ae(t)?[t]:Je(t),i=n.length,l=i-1;for(;++s<i;){const d=n[s];let v=r;if(s!==l){const k=e[d];v=I(k)||Array.isArray(k)?k:isNaN(+n[s+1])?{}:[]}if(d==="__proto__"||d==="constructor"||d==="prototype")return;e[d]=v,e=e[d]}};const wt={BLUR:"blur",FOCUS_OUT:"focusout"},ee={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ae={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},qs=z.createContext(null);qs.displayName="HookFormContext";var Us=(e,t,r,s=!0)=>{const n={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(n,i,{get:()=>{const l=i;return t._proxyFormState[l]!==ee.all&&(t._proxyFormState[l]=!s||ee.all),e[l]}});return n};const Bs=typeof window<"u"?z.useLayoutEffect:z.useEffect;var J=e=>typeof e=="string",Hs=(e,t,r,s,n)=>J(e)?(s&&t.watch.add(e),y(r,e,n)):Array.isArray(e)?e.map(i=>(s&&t.watch.add(i),y(r,i))):(s&&(t.watchAll=!0),r),Be=e=>G(e)||!Yt(e);function de(e,t,r=new WeakSet){if(Be(e)||Be(t))return Object.is(e,t);if(ye(e)&&ye(t))return e.getTime()===t.getTime();const s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const i of s){const l=e[i];if(!n.includes(i))return!1;if(i!=="ref"){const d=t[i];if(ye(l)&&ye(d)||I(l)&&I(d)||Array.isArray(l)&&Array.isArray(d)?!de(l,d,r):!Object.is(l,d))return!1}}return!0}var $s=(e,t,r,s,n)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[s]:n||!0}}:{},Ne=e=>Array.isArray(e)?e:[e],pt=()=>{let e=[];return{get observers(){return e},next:n=>{for(const i of e)i.next&&i.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(i=>i!==n)}}),unsubscribe:()=>{e=[]}}};function Rt(e,t){const r={};for(const s in e)if(e.hasOwnProperty(s)){const n=e[s],i=t[s];if(n&&I(n)&&i){const l=Rt(n,i);I(l)&&(r[s]=l)}else e[s]&&(r[s]=i)}return r}var X=e=>I(e)&&!Object.keys(e).length,Ke=e=>e.type==="file",Ve=e=>{if(!ze)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},qt=e=>e.type==="select-multiple",Ze=e=>e.type==="radio",Qs=e=>Ze(e)||Te(e),Ue=e=>Ve(e)&&e.isConnected;function Xs(e,t){const r=t.slice(0,-1).length;let s=0;for(;s<r;)e=A(e)?s++:e[t[s++]];return e}function zs(e){for(const t in e)if(e.hasOwnProperty(t)&&!A(e[t]))return!1;return!0}function W(e,t){const r=Array.isArray(t)?t:Ae(t)?[t]:Je(t),s=r.length===1?e:Xs(e,r),n=r.length-1,i=r[n];return s&&delete s[i],n!==0&&(I(s)&&X(s)||Array.isArray(s)&&zs(s))&&W(e,r.slice(0,-1)),e}var Gs=e=>{for(const t in e)if(Z(e[t]))return!0;return!1};function Ut(e){return Array.isArray(e)||I(e)&&!Gs(e)}function He(e,t={}){for(const r in e){const s=e[r];Ut(s)?(t[r]=Array.isArray(s)?[]:{},He(s,t[r])):A(s)||(t[r]=!0)}return t}function ve(e,t,r){r||(r=He(t));for(const s in e){const n=e[s];if(Ut(n))A(t)||Be(r[s])?r[s]=He(n,Array.isArray(n)?[]:{}):ve(n,G(t)?{}:t[s],r[s]);else{const i=t[s];r[s]=!de(n,i)}}return r}const kt={value:!1,isValid:!1},jt={value:!0,isValid:!0};var Bt=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!A(e[0].attributes.value)?A(e[0].value)||e[0].value===""?jt:{value:e[0].value,isValid:!0}:jt:kt}return kt},Ht=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:s})=>A(e)?e:t?e===""?NaN:e&&+e:r&&J(e)?new Date(e):s?s(e):e;const Dt={isValid:!1,value:null};var $t=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,Dt):Dt;function Mt(e){const t=e.ref;return Ke(t)?t.files:Ze(t)?$t(e.refs).value:qt(t)?[...t.selectedOptions].map(({value:r})=>r):Te(t)?Bt(e.refs).value:Ht(A(t.value)?e.ref.value:t.value,e)}var Js=(e,t,r,s)=>{const n={};for(const i of e){const l=y(t,i);l&&E(n,i,l._f)}return{criteriaMode:r,names:[...e],fields:n,shouldUseNativeValidation:s}},Ee=e=>e instanceof RegExp,Me=e=>A(e)?e:Ee(e)?e.source:I(e)?Ee(e.value)?e.value.source:e.value:e,Nt=e=>({isOnSubmit:!e||e===ee.onSubmit,isOnBlur:e===ee.onBlur,isOnChange:e===ee.onChange,isOnAll:e===ee.all,isOnTouch:e===ee.onTouched});const Ft="AsyncFunction";var Ks=e=>!!e&&!!e.validate&&!!(Z(e.validate)&&e.validate.constructor.name===Ft||I(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===Ft)),Zs=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),St=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(s=>e.startsWith(s)&&/^\.\w+/.test(e.slice(s.length))));const Fe=(e,t,r,s)=>{for(const n of r||Object.keys(e)){const i=y(e,n);if(i){const{_f:l,...d}=i;if(l){if(l.refs&&l.refs[0]&&t(l.refs[0],n)&&!s)return!0;if(l.ref&&t(l.ref,l.name)&&!s)return!0;if(Fe(d,t))break}else if(I(d)&&Fe(d,t))break}}};function Tt(e,t,r){const s=y(e,r);if(s||Ae(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const i=n.join("."),l=y(t,i),d=y(e,i);if(l&&!Array.isArray(l)&&r!==i)return{name:r};if(d&&d.type)return{name:i,error:d};if(d&&d.root&&d.root.type)return{name:`${i}.root`,error:d.root};n.pop()}return{name:r}}var en=(e,t,r,s)=>{r(e);const{name:n,...i}=e;return X(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(l=>t[l]===(!s||ee.all))},tn=(e,t,r)=>!e||!t||e===t||Ne(e).some(s=>s&&(r?s===t:s.startsWith(t)||t.startsWith(s))),rn=(e,t,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||e):(r?s.isOnBlur:n.isOnBlur)?!e:(r?s.isOnChange:n.isOnChange)?e:!0,sn=(e,t)=>!Ge(y(e,t)).length&&W(e,t),nn=(e,t,r)=>{const s=Ne(y(e,r));return E(s,"root",t[r]),E(e,r,s),e};function Ot(e,t,r="validate"){if(J(e)||Array.isArray(e)&&e.every(J)||se(e)&&!e)return{type:r,message:J(e)?e:"",ref:t}}var be=e=>I(e)&&!Ee(e)?e:{value:e,message:""},_t=async(e,t,r,s,n,i)=>{const{ref:l,refs:d,required:v,maxLength:k,minLength:_,min:p,max:S,pattern:w,validate:N,name:M,valueAsNumber:R,mount:C}=e._f,D=y(r,M);if(!C||t.has(M))return{};const H=d?d[0]:l,$=j=>{n&&H.reportValidity&&(H.setCustomValidity(se(j)?"":j||""),H.reportValidity())},V={},te=Ze(l),ce=Te(l),Q=te||ce,re=(R||Ke(l))&&A(l.value)&&A(D)||Ve(l)&&l.value===""||D===""||Array.isArray(D)&&!D.length,q=$s.bind(null,M,s,V),ne=(j,g,x,F=ae.maxLength,L=ae.minLength)=>{const U=j?g:x;V[M]={type:j?F:L,message:U,ref:l,...q(j?F:L,U)}};if(i?!Array.isArray(D)||!D.length:v&&(!Q&&(re||G(D))||se(D)&&!D||ce&&!Bt(d).isValid||te&&!$t(d).isValid)){const{value:j,message:g}=J(v)?{value:!!v,message:v}:be(v);if(j&&(V[M]={type:ae.required,message:g,ref:H,...q(ae.required,g)},!s))return $(g),V}if(!re&&(!G(p)||!G(S))){let j,g;const x=be(S),F=be(p);if(!G(D)&&!isNaN(D)){const L=l.valueAsNumber||D&&+D;G(x.value)||(j=L>x.value),G(F.value)||(g=L<F.value)}else{const L=l.valueAsDate||new Date(D),U=ke=>new Date(new Date().toDateString()+" "+ke),fe=l.type=="time",pe=l.type=="week";J(x.value)&&D&&(j=fe?U(D)>U(x.value):pe?D>x.value:L>new Date(x.value)),J(F.value)&&D&&(g=fe?U(D)<U(F.value):pe?D<F.value:L<new Date(F.value))}if((j||g)&&(ne(!!j,x.message,F.message,ae.max,ae.min),!s))return $(V[M].message),V}if((k||_)&&!re&&(J(D)||i&&Array.isArray(D))){const j=be(k),g=be(_),x=!G(j.value)&&D.length>+j.value,F=!G(g.value)&&D.length<+g.value;if((x||F)&&(ne(x,j.message,g.message),!s))return $(V[M].message),V}if(w&&!re&&J(D)){const{value:j,message:g}=be(w);if(Ee(j)&&!D.match(j)&&(V[M]={type:ae.pattern,message:g,ref:l,...q(ae.pattern,g)},!s))return $(g),V}if(N){if(Z(N)){const j=await N(D,r),g=Ot(j,H);if(g&&(V[M]={...g,...q(ae.validate,g.message)},!s))return $(g.message),V}else if(I(N)){let j={};for(const g in N){if(!X(j)&&!s)break;const x=Ot(await N[g](D,r),H,g);x&&(j={...x,...q(g,x.message)},$(x.message),s&&(V[M]=j))}if(!X(j)&&(V[M]={ref:H,...j},!s))return V}}return $(!0),V};const an={mode:ee.onSubmit,reValidateMode:ee.onChange,shouldFocusError:!0};function on(e={}){let t={...an,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Z(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},s={},n=I(t.defaultValues)||I(t.values)?Y(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:Y(n),l={action:!1,mount:!1,watch:!1,keepIsValid:!1},d={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},v,k=0;const _={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},p={..._};let S={...p};const w={array:pt(),state:pt()},N=t.criteriaMode===ee.all,M=a=>o=>{clearTimeout(k),k=setTimeout(a,o)},R=async a=>{if(!l.keepIsValid&&!t.disabled&&(p.isValid||S.isValid||a)){let o;t.resolver?(o=X((await Q()).errors),C()):o=await q(s,!0),o!==r.isValid&&w.state.next({isValid:o})}},C=(a,o)=>{!t.disabled&&(p.isValidating||p.validatingFields||S.isValidating||S.validatingFields)&&((a||Array.from(d.mount)).forEach(u=>{u&&(o?E(r.validatingFields,u,o):W(r.validatingFields,u))}),w.state.next({validatingFields:r.validatingFields,isValidating:!X(r.validatingFields)}))},D=(a,o=[],u,m,h=!0,f=!0)=>{if(m&&u&&!t.disabled){if(l.action=!0,f&&Array.isArray(y(s,a))){const b=u(y(s,a),m.argA,m.argB);h&&E(s,a,b)}if(f&&Array.isArray(y(r.errors,a))){const b=u(y(r.errors,a),m.argA,m.argB);h&&E(r.errors,a,b),sn(r.errors,a)}if((p.touchedFields||S.touchedFields)&&f&&Array.isArray(y(r.touchedFields,a))){const b=u(y(r.touchedFields,a),m.argA,m.argB);h&&E(r.touchedFields,a,b)}(p.dirtyFields||S.dirtyFields)&&(r.dirtyFields=ve(n,i)),w.state.next({name:a,isDirty:j(a,o),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else E(i,a,o)},H=(a,o)=>{E(r.errors,a,o),w.state.next({errors:r.errors})},$=a=>{r.errors=a,w.state.next({errors:r.errors,isValid:!1})},V=(a,o,u,m)=>{const h=y(s,a);if(h){const f=y(i,a,A(u)?y(n,a):u);A(f)||m&&m.defaultChecked||o?E(i,a,o?f:Mt(h._f)):F(a,f),l.mount&&!l.action&&R()}},te=(a,o,u,m,h)=>{let f=!1,b=!1;const T={name:a};if(!t.disabled){if(!u||m){(p.isDirty||S.isDirty)&&(b=r.isDirty,r.isDirty=T.isDirty=j(),f=b!==T.isDirty);const P=de(y(n,a),o);b=!!y(r.dirtyFields,a),P?W(r.dirtyFields,a):E(r.dirtyFields,a,!0),T.dirtyFields=r.dirtyFields,f=f||(p.dirtyFields||S.dirtyFields)&&b!==!P}if(u){const P=y(r.touchedFields,a);P||(E(r.touchedFields,a,u),T.touchedFields=r.touchedFields,f=f||(p.touchedFields||S.touchedFields)&&P!==u)}f&&h&&w.state.next(T)}return f?T:{}},ce=(a,o,u,m)=>{const h=y(r.errors,a),f=(p.isValid||S.isValid)&&se(o)&&r.isValid!==o;if(t.delayError&&u?(v=M(()=>H(a,u)),v(t.delayError)):(clearTimeout(k),v=null,u?E(r.errors,a,u):W(r.errors,a)),(u?!de(h,u):h)||!X(m)||f){const b={...m,...f&&se(o)?{isValid:o}:{},errors:r.errors,name:a};r={...r,...b},w.state.next(b)}},Q=async a=>(C(a,!0),await t.resolver(i,t.context,Js(a||d.mount,s,t.criteriaMode,t.shouldUseNativeValidation))),re=async a=>{const{errors:o}=await Q(a);if(C(a),a)for(const u of a){const m=y(o,u);m?E(r.errors,u,m):W(r.errors,u)}else r.errors=o;return o},q=async(a,o,u={valid:!0})=>{for(const m in a){const h=a[m];if(h){const{_f:f,...b}=h;if(f){const T=d.array.has(f.name),P=h._f&&Ks(h._f);P&&p.validatingFields&&C([f.name],!0);const K=await _t(h,d.disabled,i,N,t.shouldUseNativeValidation&&!o,T);if(P&&p.validatingFields&&C([f.name]),K[f.name]&&(u.valid=!1,o))break;!o&&(y(K,f.name)?T?nn(r.errors,K,f.name):E(r.errors,f.name,K[f.name]):W(r.errors,f.name))}!X(b)&&await q(b,o,u)}}return u.valid},ne=()=>{for(const a of d.unMount){const o=y(s,a);o&&(o._f.refs?o._f.refs.every(u=>!Ue(u)):!Ue(o._f.ref))&&We(a)}d.unMount=new Set},j=(a,o)=>!t.disabled&&(a&&o&&E(i,a,o),!de(et(),n)),g=(a,o,u)=>Hs(a,d,{...l.mount?i:A(o)?n:J(a)?{[a]:o}:o},u,o),x=a=>Ge(y(l.mount?i:n,a,t.shouldUnregister?y(n,a,[]):[])),F=(a,o,u={})=>{const m=y(s,a);let h=o;if(m){const f=m._f;f&&(!f.disabled&&E(i,a,Ht(o,f)),h=Ve(f.ref)&&G(o)?"":o,qt(f.ref)?[...f.ref.options].forEach(b=>b.selected=h.includes(b.value)):f.refs?Te(f.ref)?f.refs.forEach(b=>{(!b.defaultChecked||!b.disabled)&&(Array.isArray(h)?b.checked=!!h.find(T=>T===b.value):b.checked=h===b.value||!!h)}):f.refs.forEach(b=>b.checked=b.value===h):Ke(f.ref)?f.ref.value="":(f.ref.value=h,f.ref.type||w.state.next({name:a,values:Y(i)})))}(u.shouldDirty||u.shouldTouch)&&te(a,h,u.shouldTouch,u.shouldDirty,!0),u.shouldValidate&&ke(a)},L=(a,o,u)=>{for(const m in o){if(!o.hasOwnProperty(m))return;const h=o[m],f=a+"."+m,b=y(s,f);(d.array.has(a)||I(h)||b&&!b._f)&&!ye(h)?L(f,h,u):F(f,h,u)}},U=(a,o,u={})=>{const m=y(s,a),h=d.array.has(a),f=Y(o);E(i,a,f),h?(w.array.next({name:a,values:Y(i)}),(p.isDirty||p.dirtyFields||S.isDirty||S.dirtyFields)&&u.shouldDirty&&w.state.next({name:a,dirtyFields:ve(n,i),isDirty:j(a,f)})):m&&!m._f&&!G(f)?L(a,f,u):F(a,f,u),St(a,d)&&w.state.next({...r,name:a}),w.state.next({name:l.mount?a:void 0,values:Y(i)})},fe=async a=>{l.mount=!0;const o=a.target;let u=o.name,m=!0;const h=y(s,u),f=P=>{m=Number.isNaN(P)||ye(P)&&isNaN(P.getTime())||de(P,y(i,u,P))},b=Nt(t.mode),T=Nt(t.reValidateMode);if(h){let P,K;const Oe=o.type?Mt(h._f):Is(a),le=a.type===wt.BLUR||a.type===wt.FOCUS_OUT,er=!Zs(h._f)&&!t.resolver&&!y(r.errors,u)&&!h._f.deps||rn(le,y(r.touchedFields,u),r.isSubmitted,T,b),Ye=St(u,d,le);E(i,u,Oe),le?(!o||!o.readOnly)&&(h._f.onBlur&&h._f.onBlur(a),v&&v(0)):h._f.onChange&&h._f.onChange(a);const Re=te(u,Oe,le),tr=!X(Re)||Ye;if(!le&&w.state.next({name:u,type:a.type,values:Y(i)}),er)return(p.isValid||S.isValid)&&(t.mode==="onBlur"?le&&R():le||R()),tr&&w.state.next({name:u,...Ye?{}:Re});if(!le&&Ye&&w.state.next({...r}),t.resolver){const{errors:lt}=await Q([u]);if(C([u]),f(Oe),m){const rr=Tt(r.errors,s,u),ut=Tt(lt,s,rr.name||u);P=ut.error,u=ut.name,K=X(lt)}}else C([u],!0),P=(await _t(h,d.disabled,i,N,t.shouldUseNativeValidation))[u],C([u]),f(Oe),m&&(P?K=!1:(p.isValid||S.isValid)&&(K=await q(s,!0)));m&&(h._f.deps&&(!Array.isArray(h._f.deps)||h._f.deps.length>0)&&ke(h._f.deps),ce(u,K,P,Re))}},pe=(a,o)=>{if(y(r.errors,o)&&a.focus)return a.focus(),1},ke=async(a,o={})=>{let u,m;const h=Ne(a);if(t.resolver){const f=await re(A(a)?a:h);u=X(f),m=a?!h.some(b=>y(f,b)):u}else a?(m=(await Promise.all(h.map(async f=>{const b=y(s,f);return await q(b&&b._f?{[f]:b}:b)}))).every(Boolean),!(!m&&!r.isValid)&&R()):m=u=await q(s);return w.state.next({...!J(a)||(p.isValid||S.isValid)&&u!==r.isValid?{}:{name:a},...t.resolver||!a?{isValid:u}:{},errors:r.errors}),o.shouldFocus&&!m&&Fe(s,pe,a?h:d.mount),m},et=(a,o)=>{let u={...l.mount?i:n};return o&&(u=Rt(o.dirtyFields?r.dirtyFields:r.touchedFields,u)),A(a)?u:J(a)?y(u,a):a.map(m=>y(u,m))},tt=(a,o)=>({invalid:!!y((o||r).errors,a),isDirty:!!y((o||r).dirtyFields,a),error:y((o||r).errors,a),isValidating:!!y(r.validatingFields,a),isTouched:!!y((o||r).touchedFields,a)}),Qt=a=>{a&&Ne(a).forEach(o=>W(r.errors,o)),w.state.next({errors:a?r.errors:{}})},rt=(a,o,u)=>{const m=(y(s,a,{_f:{}})._f||{}).ref,h=y(r.errors,a)||{},{ref:f,message:b,type:T,...P}=h;E(r.errors,a,{...P,...o,ref:m}),w.state.next({name:a,errors:r.errors,isValid:!1}),u&&u.shouldFocus&&m&&m.focus&&m.focus()},Xt=(a,o)=>Z(a)?w.state.subscribe({next:u=>"values"in u&&a(g(void 0,o),u)}):g(a,o,!0),st=a=>w.state.subscribe({next:o=>{tn(a.name,o.name,a.exact)&&en(o,a.formState||p,Zt,a.reRenderRoot)&&a.callback({values:{...i},...r,...o,defaultValues:n})}}).unsubscribe,zt=a=>(l.mount=!0,S={...S,...a.formState},st({...a,formState:{..._,...a.formState}})),We=(a,o={})=>{for(const u of a?Ne(a):d.mount)d.mount.delete(u),d.array.delete(u),o.keepValue||(W(s,u),W(i,u)),!o.keepError&&W(r.errors,u),!o.keepDirty&&W(r.dirtyFields,u),!o.keepTouched&&W(r.touchedFields,u),!o.keepIsValidating&&W(r.validatingFields,u),!t.shouldUnregister&&!o.keepDefaultValue&&W(n,u);w.state.next({values:Y(i)}),w.state.next({...r,...o.keepDirty?{isDirty:j()}:{}}),!o.keepIsValid&&R()},nt=({disabled:a,name:o})=>{(se(a)&&l.mount||a||d.disabled.has(o))&&(a?d.disabled.add(o):d.disabled.delete(o))},Ie=(a,o={})=>{let u=y(s,a);const m=se(o.disabled)||se(t.disabled);return E(s,a,{...u||{},_f:{...u&&u._f?u._f:{ref:{name:a}},name:a,mount:!0,...o}}),d.mount.add(a),u?nt({disabled:se(o.disabled)?o.disabled:t.disabled,name:a}):V(a,!0,o.value),{...m?{disabled:o.disabled||t.disabled}:{},...t.progressive?{required:!!o.required,min:Me(o.min),max:Me(o.max),minLength:Me(o.minLength),maxLength:Me(o.maxLength),pattern:Me(o.pattern)}:{},name:a,onChange:fe,onBlur:fe,ref:h=>{if(h){Ie(a,o),u=y(s,a);const f=A(h.value)&&h.querySelectorAll&&h.querySelectorAll("input,select,textarea")[0]||h,b=Qs(f),T=u._f.refs||[];if(b?T.find(P=>P===f):f===u._f.ref)return;E(s,a,{_f:{...u._f,...b?{refs:[...T.filter(Ue),f,...Array.isArray(y(n,a))?[{}]:[]],ref:{type:f.type,name:a}}:{ref:f}}}),V(a,!1,void 0,f)}else u=y(s,a,{}),u._f&&(u._f.mount=!1),(t.shouldUnregister||o.shouldUnregister)&&!(Ys(d.array,a)&&l.action)&&d.unMount.add(a)}}},Le=()=>t.shouldFocusError&&Fe(s,pe,d.mount),Gt=a=>{se(a)&&(w.state.next({disabled:a}),Fe(s,(o,u)=>{const m=y(s,u);m&&(o.disabled=m._f.disabled||a,Array.isArray(m._f.refs)&&m._f.refs.forEach(h=>{h.disabled=m._f.disabled||a}))},0,!1))},at=(a,o)=>async u=>{let m;u&&(u.preventDefault&&u.preventDefault(),u.persist&&u.persist());let h=Y(i);if(w.state.next({isSubmitting:!0}),t.resolver){const{errors:f,values:b}=await Q();C(),r.errors=f,h=Y(b)}else await q(s);if(d.disabled.size)for(const f of d.disabled)W(h,f);if(W(r.errors,"root"),X(r.errors)){w.state.next({errors:{}});try{await a(h,u)}catch(f){m=f}}else o&&await o({...r.errors},u),Le(),setTimeout(Le);if(w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:X(r.errors)&&!m,submitCount:r.submitCount+1,errors:r.errors}),m)throw m},Jt=(a,o={})=>{y(s,a)&&(A(o.defaultValue)?U(a,Y(y(n,a))):(U(a,o.defaultValue),E(n,a,Y(o.defaultValue))),o.keepTouched||W(r.touchedFields,a),o.keepDirty||(W(r.dirtyFields,a),r.isDirty=o.defaultValue?j(a,Y(y(n,a))):j()),o.keepError||(W(r.errors,a),p.isValid&&R()),w.state.next({...r}))},it=(a,o={})=>{const u=a?Y(a):n,m=Y(u),h=X(a),f=h?n:m;if(o.keepDefaultValues||(n=u),!o.keepValues){if(o.keepDirtyValues){const b=new Set([...d.mount,...Object.keys(ve(n,i))]);for(const T of Array.from(b))y(r.dirtyFields,T)?E(f,T,y(i,T)):U(T,y(f,T))}else{if(ze&&A(a))for(const b of d.mount){const T=y(s,b);if(T&&T._f){const P=Array.isArray(T._f.refs)?T._f.refs[0]:T._f.ref;if(Ve(P)){const K=P.closest("form");if(K){K.reset();break}}}}if(o.keepFieldsRef)for(const b of d.mount)U(b,y(f,b));else s={}}i=t.shouldUnregister?o.keepDefaultValues?Y(n):{}:Y(f),w.array.next({values:{...f}}),w.state.next({values:{...f}})}d={mount:o.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!p.isValid||!!o.keepIsValid||!!o.keepDirtyValues||!t.shouldUnregister&&!X(f),l.watch=!!t.shouldUnregister,l.keepIsValid=!!o.keepIsValid,l.action=!1,o.keepErrors||(r.errors={}),w.state.next({submitCount:o.keepSubmitCount?r.submitCount:0,isDirty:h?!1:o.keepDirty?r.isDirty:!!(o.keepDefaultValues&&!de(a,n)),isSubmitted:o.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:h?{}:o.keepDirtyValues?o.keepDefaultValues&&i?ve(n,i):r.dirtyFields:o.keepDefaultValues&&a?ve(n,a):o.keepDirty?r.dirtyFields:{},touchedFields:o.keepTouched?r.touchedFields:{},errors:o.keepErrors?r.errors:{},isSubmitSuccessful:o.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},ot=(a,o)=>it(Z(a)?a(i):a,{...t.resetOptions,...o}),Kt=(a,o={})=>{const u=y(s,a),m=u&&u._f;if(m){const h=m.refs?m.refs[0]:m.ref;h.focus&&setTimeout(()=>{h.focus(),o.shouldSelect&&Z(h.select)&&h.select()})}},Zt=a=>{r={...r,...a}},ct={control:{register:Ie,unregister:We,getFieldState:tt,handleSubmit:at,setError:rt,_subscribe:st,_runSchema:Q,_updateIsValidating:C,_focusError:Le,_getWatch:g,_getDirty:j,_setValid:R,_setFieldArray:D,_setDisabledField:nt,_setErrors:$,_getFieldArray:x,_reset:it,_resetDefaultValues:()=>Z(t.defaultValues)&&t.defaultValues().then(a=>{ot(a,t.resetOptions),w.state.next({isLoading:!1})}),_removeUnmounted:ne,_disableForm:Gt,_subjects:w,_proxyFormState:p,get _fields(){return s},get _formValues(){return i},get _state(){return l},set _state(a){l=a},get _defaultValues(){return n},get _names(){return d},set _names(a){d=a},get _formState(){return r},get _options(){return t},set _options(a){t={...t,...a}}},subscribe:zt,trigger:ke,register:Ie,handleSubmit:at,watch:Xt,setValue:U,getValues:et,reset:ot,resetField:Jt,clearErrors:Qt,unregister:We,setError:rt,setFocus:Kt,getFieldState:tt};return{...ct,formControl:ct}}function cn(e={}){const t=z.useRef(void 0),r=z.useRef(void 0),[s,n]=z.useState({isDirty:!1,isValidating:!1,isLoading:Z(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Z(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:s},e.defaultValues&&!Z(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:l,...d}=on(e);t.current={...d,formState:s}}const i=t.current.control;return i._options=e,Bs(()=>{const l=i._subscribe({formState:i._proxyFormState,callback:()=>n({...i._formState}),reRenderRoot:!0});return n(d=>({...d,isReady:!0})),i._formState.isReady=!0,l},[i]),z.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),z.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),z.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),z.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),z.useEffect(()=>{if(i._proxyFormState.isDirty){const l=i._getDirty();l!==s.isDirty&&i._subjects.state.next({isDirty:l})}},[i,s.isDirty]),z.useEffect(()=>{var l;e.values&&!de(e.values,r.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),!((l=i._options.resetOptions)===null||l===void 0)&&l.keepIsValid||i._setValid(),r.current=e.values,n(d=>({...d}))):i._resetDefaultValues()},[i,e.values]),z.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=Us(s,i),t.current}const ln=({defaultDate:e=null,trade:t=null,tags:r=[],onClose:s})=>{var g;const{showToast:n}=Vt(),i=lr(),l=Qe(x=>x.settings.currency),d=!!t,v=new Date,k=e||v.toISOString().split("T")[0],_=v.toTimeString().slice(0,5),{register:p,handleSubmit:S,watch:w,setValue:N,formState:{errors:M}}=cn({defaultValues:{date:(t==null?void 0:t.date)||k,time:(t==null?void 0:t.time)||_,amount:(t==null?void 0:t.amount)||"",tagId:(t==null?void 0:t.tagId)||((g=r[0])==null?void 0:g.tagId)||"",notes:(t==null?void 0:t.notes)||""}}),[R,C]=ge.useState(null),[D,H]=ge.useState(t!=null&&t.driveImageId?`drive://${t.driveImageId}`:null),[$,V]=ge.useState(!1),te=w("amount"),ce=w("tagId"),Q=r.find(x=>x.tagId===ce),re=x=>{N("amount",x)},q=x=>{var L;const F=(L=x.target.files)==null?void 0:L[0];if(F){if(!F.type.startsWith("image/")){n("Please select an image file","error");return}if(F.size>10*1024*1024){n("Image too large (max 10MB)","error");return}C(F),H(URL.createObjectURL(F))}},ne=()=>{C(null),H(null)},j=async x=>{if(!x.amount||x.amount===0){n("Please enter an amount","error");return}if(!x.tagId){n("Please select a tag","error");return}try{V(!0);const F=r.find(U=>U.tagId===x.tagId),L={tradeId:(t==null?void 0:t.tradeId)||ur(),date:x.date,time:x.time,amount:parseFloat(x.amount),tagId:x.tagId,tagName:F.name,tagColor:F.color,tagEmoji:F.emoji,screenshot:R,notes:x.notes};await i.mutateAsync(L),n(d?"Trade updated":"Trade added","success"),s()}catch(F){console.error("Failed to save trade:",F),n("Failed to save trade","error")}finally{V(!1)}};return c.jsx(Xe,{isOpen:!0,onClose:s,title:d?"Edit Trade":"Add Trade",children:c.jsxs("form",{onSubmit:S(j),className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),c.jsx("input",{type:"date",...p("date",{required:!0}),className:"input"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time"}),c.jsx("input",{type:"time",...p("time",{required:!0}),className:"input"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-2xl font-bold text-text-tertiary",children:l}),c.jsx("input",{type:"number",step:"0.01",...p("amount",{required:!0,valueAsNumber:!0}),className:`
                input pl-12 text-3xl font-bold text-center
                ${te>0?"text-profit":te<0?"text-loss":""}
              `,placeholder:"0.00"})]}),c.jsx("div",{className:"flex gap-2 mt-2",children:sr.map(x=>c.jsxs("button",{type:"button",onClick:()=>re(x),className:`
                  flex-1 py-2 px-3 rounded-md text-sm font-medium
                  transition-colors
                  ${x>0?"bg-profit/10 text-profit hover:bg-profit/20":"bg-loss/10 text-loss hover:bg-loss/20"}
                `,children:[x>0?"+":"",x]},x))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Strategy Tag"}),c.jsx("select",{...p("tagId",{required:!0}),className:"input",children:r.map(x=>c.jsxs("option",{value:x.tagId,children:[x.emoji," ",x.name]},x.tagId))}),Q&&c.jsxs("div",{className:"mt-2 p-2 rounded-md text-sm",style:{backgroundColor:`${Q.color}20`,color:Q.color},children:[c.jsx("span",{className:"text-xl mr-2",children:Q.emoji}),Q.name]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Screenshot (optional)"}),D?c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:D,alt:"Screenshot preview",className:"w-full h-48 object-cover rounded-lg"}),c.jsx("button",{type:"button",onClick:ne,className:"absolute top-2 right-2 p-2 bg-black/50 rounded-full hover:bg-black/70 transition-colors",children:c.jsx(Pt,{size:20,className:"text-white"})})]}):c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("label",{className:"cursor-pointer",children:[c.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:q,className:"hidden"}),c.jsxs("div",{className:"card border-2 border-dashed border-border hover:border-accent transition-colors text-center py-8",children:[c.jsx(xr,{size:32,className:"mx-auto mb-2 text-text-secondary"}),c.jsx("div",{className:"text-sm text-text-secondary",children:"Take Photo"})]})]}),c.jsxs("label",{className:"cursor-pointer",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"hidden"}),c.jsxs("div",{className:"card border-2 border-dashed border-border hover:border-accent transition-colors text-center py-8",children:[c.jsx(Dr,{size:32,className:"mx-auto mb-2 text-text-secondary"}),c.jsx("div",{className:"text-sm text-text-secondary",children:"Upload"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes (optional)"}),c.jsx("textarea",{...p("notes"),rows:3,className:"input resize-none",placeholder:"What happened? What did you learn?"})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx(we,{type:"button",variant:"secondary",onClick:s,className:"flex-1",disabled:$,children:"Cancel"}),c.jsx(we,{type:"submit",className:"flex-1",loading:$,children:d?"Update Trade":"Save Trade"})]})]})})},wn=()=>{const{year:e,month:t}=nr(),r=ar(),s=new Date,n=e?parseInt(e):s.getFullYear(),i=t?parseInt(t):s.getMonth(),l=new Date(n,i),[d,v]=ge.useState(null),[k,_]=ge.useState(!1),[p,S]=ge.useState("calendar"),w=Qe(g=>g.settings.currency),{data:N=[],isLoading:M}=dr(n,i),{data:R=[]}=gr(),C=fr(N),D=hr(N),H=mr(N),$=Vr(l),V=_r(l),te=Pr({start:$,end:V}),ce=Vs($),Q=Array(ce).fill(null),re=()=>{const g=Es(l);r(`/month/${g.getFullYear()}/${g.getMonth()}`)},q=()=>{const g=At(l,1);r(`/month/${g.getFullYear()}/${g.getMonth()}`)},ne=g=>{ht(g)||v(me(g,"yyyy-MM-dd"))},j=()=>{_(!0)};return M?c.jsxs(c.Fragment,{children:[c.jsx(mt,{title:"Loading..."}),c.jsx("div",{className:"p-4",children:c.jsx(ir,{type:"spinner"})})]}):c.jsxs(c.Fragment,{children:[c.jsx(mt,{title:me(l,"MMMM yyyy"),showBack:!0,actions:c.jsx("button",{onClick:()=>S(p==="calendar"?"list":"calendar"),className:"p-2 hover:bg-surface rounded-lg transition-colors",title:p==="calendar"?"List view":"Calendar view",children:c.jsx(wr,{size:20,className:"text-text-secondary"})})}),c.jsxs("div",{className:"p-4 max-w-7xl mx-auto space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("button",{onClick:re,className:"p-2 hover:bg-surface rounded-lg transition-colors",children:c.jsx(br,{size:24,className:"text-text-secondary"})}),c.jsx("h2",{className:"text-xl font-semibold",children:me(l,"MMMM yyyy")}),c.jsx("button",{onClick:q,className:"p-2 hover:bg-surface rounded-lg transition-colors",children:c.jsx(vr,{size:24,className:"text-text-secondary"})})]}),c.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[c.jsx(_e,{label:"P&L",value:Ct(C.totalPL,w),color:C.totalPL>=0?"profit":"loss"}),c.jsx(_e,{label:"Trades",value:C.tradeCount}),c.jsx(_e,{label:"Win Rate",value:`${C.winRate}%`,color:C.winRate>=50?"profit":"loss"}),c.jsx(_e,{label:"W/L",value:`${C.winCount}/${C.lossCount}`})]}),p==="calendar"?c.jsxs("div",{className:"card",children:[c.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(g=>c.jsx("div",{className:"text-center text-sm font-medium text-text-secondary py-2",children:g},g))}),c.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[Q.map((g,x)=>c.jsx("div",{className:"aspect-square"},`empty-${x}`)),te.map(g=>{const x=me(g,"yyyy-MM-dd"),F=D[x]||0,L=H[x]||[],U=ht(g),fe=yr(g,new Date);return c.jsx(un,{date:g,pl:F,tradeCount:L.length,isWeekend:U,isToday:fe,currency:w,onClick:()=>ne(g)},x)})]})]}):c.jsx(dn,{trades:N,groupedTrades:H,currency:w,onDayClick:ne})]}),c.jsx(Cs,{onClick:j}),d&&c.jsx(As,{date:d,trades:H[d]||[],onClose:()=>v(null),onAddTrade:j}),k&&c.jsx(ln,{defaultDate:d,tags:R,onClose:()=>_(!1)})]})},_e=({label:e,value:t,color:r="default"})=>{const s={profit:"text-profit",loss:"text-loss",default:"text-text-primary"};return c.jsxs("div",{className:"card text-center",children:[c.jsx("div",{className:"text-text-tertiary text-xs mb-1",children:e}),c.jsx("div",{className:`text-lg font-bold ${s[r]}`,children:t})]})},un=({date:e,pl:t,tradeCount:r,isWeekend:s,isToday:n,currency:i,onClick:l})=>{const d=me(e,"d");if(s)return c.jsxs("div",{className:"aspect-square bg-surface/50 rounded-lg p-2 flex flex-col items-center justify-center opacity-50",children:[c.jsx("div",{className:"text-sm text-text-tertiary",children:d}),c.jsx("div",{className:"text-xs text-text-tertiary",children:""})]});const v=t>0?"bg-profit/10":t<0?"bg-loss/10":"bg-surface",k=n?"ring-2 ring-accent":"border border-border";return c.jsxs("button",{onClick:l,className:`
        aspect-square ${v} ${k} rounded-lg p-2
        hover:bg-surface-hover transition-all
        flex flex-col items-center justify-between
        relative
      `,children:[c.jsx("div",{className:"text-sm text-text-secondary",children:d}),r>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`text-sm font-semibold ${t>=0?"text-profit":"text-loss"}`,children:Ct(t,i)}),r>1&&c.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 rounded-full bg-accent text-white text-xs flex items-center justify-center",children:r})]})]})},dn=({trades:e,groupedTrades:t,currency:r,onDayClick:s})=>{const n=Object.keys(t).sort().reverse();return n.length===0?c.jsx("div",{className:"card text-center py-12",children:c.jsx("p",{className:"text-text-secondary",children:"No trades this month"})}):c.jsx("div",{className:"space-y-2",children:n.map(i=>{const l=t[i],d=l.reduce((v,k)=>v+k.amount,0);return c.jsx("button",{onClick:()=>s(i),className:"card w-full text-left hover:bg-surface-hover transition-colors",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:me(new Date(i),"EEEE, MMMM d")}),c.jsxs("div",{className:"text-sm text-text-tertiary",children:[l.length," trade",l.length!==1?"s":""]})]}),c.jsx("div",{className:`text-xl font-bold ${d>=0?"text-profit":"text-loss"}`,children:$e(d,r)})]})},i)})})};export{wn as default};
