import{d as w,a as I,u as z,j as e,k as E,f as L,r as f,C as M,S as v}from"./index-bno3-3QJ.js";import{a as R,u as Y}from"./settingsStore-DvusL_y7.js";import{T as y}from"./trash-2-x11vlF9C.js";import"./useMutation-Cg24QtMB.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=w("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=w("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),U=({title:r="TradeZen",showBack:n=!1,actions:c=null})=>{const o=I(),u=z(a=>a.signOut),d=()=>{confirm("Are you sure you want to sign out?")&&(u(),o("/"))};return e.jsx("header",{className:"sticky top-0 bg-background border-b border-border z-30",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsx("button",{onClick:()=>o(-1),className:"p-2 hover:bg-surface rounded-lg transition-colors",children:e.jsx(O,{size:20,className:"text-text-secondary"})}),e.jsx("h1",{className:"text-xl font-bold text-text-primary",children:r})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c,e.jsx("button",{onClick:d,className:"p-2 hover:bg-surface rounded-lg transition-colors",title:"Sign out",children:e.jsx(E,{size:20,className:"text-text-secondary"})})]})]})})},W=()=>{const{settings:r,updateSettings:n}=R(),{data:c=[]}=Y(),o=L(),[u,d]=f.useState(!1),[a,p]=f.useState([]),[g,N]=f.useState(!1),b=[...new Set(c.map(s=>parseInt(s.date.split("-")[0])))].sort((s,t)=>t-s),S=async()=>{if(a.length===0){alert("Please select at least one year to delete");return}if(confirm(`Are you sure you want to delete ALL data for ${a.join(", ")}?

This will permanently delete:
- All trades
- All tags
- All screenshots

This cannot be undone!`)){N(!0);try{const t="1ruzm5D-ofifAU7d5oRChBT7DAYFTlVLgULSsXvYEtXU",A=(await window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:t,range:`${v.TRADES}!A2:L`})).result.values||[],h=[];A.forEach((l,j)=>{const D=l[1],T=parseInt(D.split("-")[0]);a.includes(T)&&h.push(j+2)}),h.sort((l,j)=>j-l);const k=(await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:t})).result.sheets.find(l=>l.properties.title===v.TRADES).properties.sheetId;for(const l of h)await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t,resource:{requests:[{deleteDimension:{range:{sheetId:k,dimension:"ROWS",startIndex:l-1,endIndex:l}}}]}});o.invalidateQueries({queryKey:["trades"]}),alert(`Successfully deleted ${h.length} trades from ${a.join(", ")}!`),d(!1),p([])}catch(t){console.error("Failed to clear data:",t),alert("Failed to delete data: "+t.message)}finally{N(!1)}}},C=s=>{p(t=>t.includes(s)?t.filter(x=>x!==s):[...t,s])};return e.jsxs(e.Fragment,{children:[e.jsx(U,{title:"Settings"}),e.jsxs("div",{className:"p-4 max-w-3xl mx-auto space-y-6",children:[e.jsx(m,{title:"Appearance",children:e.jsx(i,{label:"Theme",children:e.jsx("div",{className:"text-text-secondary text-sm",children:"Dark (Always On)"})})}),e.jsx(m,{title:"Preferences",children:e.jsx(i,{label:"Currency",children:e.jsx("select",{value:r.currency,onChange:s=>n({currency:s.target.value}),className:"input py-2",children:M.map(s=>e.jsxs("option",{value:s.symbol,children:[s.symbol," ",s.code]},s.code))})})}),e.jsxs(m,{title:"Data Management",children:[e.jsx(i,{label:"Storage",children:e.jsx("div",{className:"text-text-secondary text-sm",children:"Google Sheets & Drive"})}),e.jsx(i,{label:"Clear Data",children:e.jsxs("button",{onClick:()=>d(!0),disabled:b.length===0,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-all flex items-center gap-2 font-semibold",children:[e.jsx(y,{size:16}),"Delete Year Data"]})})]}),e.jsx(m,{title:"About",children:e.jsx(i,{label:"Version",children:e.jsx("div",{className:"text-text-secondary text-sm",children:"1.0.0"})})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-red-500/50 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-red-600/20 rounded-full",children:e.jsx(F,{size:24,className:"text-red-500"})}),e.jsx("h3",{className:"text-2xl font-black text-red-500",children:"Delete Data"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-slate-300 mb-4",children:"Select which year(s) you want to delete:"}),b.length===0?e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No data to delete"}):e.jsx("div",{className:"space-y-2",children:b.map(s=>{const t=c.filter(x=>parseInt(x.date.split("-")[0])===s);return e.jsxs("label",{className:`flex items-center gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all ${a.includes(s)?"border-red-500 bg-red-500/10":"border-slate-700 hover:border-slate-600"}`,children:[e.jsx("input",{type:"checkbox",checked:a.includes(s),onChange:()=>C(s),className:"w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-lg",children:s}),e.jsxs("div",{className:"text-sm text-slate-400",children:[t.length," trade",t.length!==1?"s":""]})]}),a.includes(s)&&e.jsx(y,{size:20,className:"text-red-500"})]},s)})}),a.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("p",{className:"text-red-400 text-sm font-semibold",children:["⚠️ This will permanently delete all trades, tags, and screenshots for ",a.join(", ")]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{d(!1),p([])},disabled:g,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{onClick:S,disabled:a.length===0||g,className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 disabled:opacity-50 rounded-lg transition-all font-semibold flex items-center justify-center gap-2",children:g?e.jsx(e.Fragment,{children:"Deleting..."}):e.jsxs(e.Fragment,{children:[e.jsx(y,{size:16}),"Delete Selected"]})})]})]})})]})},m=({title:r,children:n})=>e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 pb-3 border-b border-border",children:r}),e.jsx("div",{className:"space-y-4",children:n})]}),i=({label:r,children:n})=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-sm font-medium",children:r}),e.jsx("div",{children:n})]});export{W as default};
