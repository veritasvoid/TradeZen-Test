function g(e,t){const n=N(e);let a;if(n.date){const o=T(n.date,2);a=C(o.restDateString,o.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let s=0,c;if(n.time&&(s=w(n.time),isNaN(s)))return new Date(NaN);if(n.timezone){if(c=I(n.timezone),isNaN(c))return new Date(NaN)}else{const o=new Date(i+s),u=new Date(0);return u.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),u.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),u}return new Date(i+s+c)}const f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},D=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,p=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,h=/^([+-])(\d{2})(?::?(\d{2}))?$/;function N(e){const t={},r=e.split(f.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],f.timeZoneDelimiter.test(t.date)&&(t.date=e.split(f.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=f.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function T(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function C(e,t){if(t===null)return new Date(NaN);const r=e.match(D);if(!r)return new Date(NaN);const n=!!r[4],a=l(r[1]),i=l(r[2])-1,s=l(r[3]),c=l(r[4]),o=l(r[5])-1;if(n)return Y(t,c,o)?U(t,c,o):new Date(NaN);{const u=new Date(0);return!M(t,i,s)||!y(t,a)?new Date(NaN):(u.setUTCFullYear(t,i,Math.max(a,s)),u)}}function l(e){return e?parseInt(e):1}function w(e){const t=e.match(p);if(!t)return NaN;const r=d(t[1]),n=d(t[2]),a=d(t[3]);return $(r,n,a)?r*36e5+n*6e4+a*1e3:NaN}function d(e){return e&&parseFloat(e.replace(",","."))||0}function I(e){if(e==="Z")return 0;const t=e.match(h);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return F(n,a)?r*(n*36e5+a*6e4):NaN}function U(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const x=[31,null,31,30,31,30,31,31,30,31,30,31];function m(e){return e%400===0||e%4===0&&e%100!==0}function M(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(x[t]||(m(e)?29:28))}function y(e,t){return t>=1&&t<=(m(e)?366:365)}function Y(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function $(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function F(e,t){return t>=0&&t<=59}const v=(e,t="$")=>{const r=Math.abs(e);let n;return r>=1e6?n=`${(r/1e6).toFixed(1)}M`:r>=1e3?n=`${(r/1e3).toFixed(1)}K`:n=r.toFixed(0),`${e>=0?"+":"-"}${t}${n}`},R=(e,t)=>{const r=e+t;return r===0?0:Math.round(e/r*100)},W=e=>{if(!e||e.length===0)return{totalPL:0,tradeCount:0,winCount:0,lossCount:0,winRate:0,avgWin:0,avgLoss:0};const t=e.reduce((s,c)=>s+c.amount,0),r=e.filter(s=>s.amount>0),n=e.filter(s=>s.amount<0),a=r.length>0?r.reduce((s,c)=>s+c.amount,0)/r.length:0,i=n.length>0?n.reduce((s,c)=>s+Math.abs(c.amount),0)/n.length:0;return{totalPL:t,tradeCount:e.length,winCount:r.length,lossCount:n.length,winRate:R(r.length,n.length),avgWin:a,avgLoss:i}},z=(e,t)=>Array.from({length:12},(n,a)=>a).map(n=>{const a=e.filter(i=>{const s=g(i.date);return s.getFullYear()===t&&s.getMonth()===n});return{month:n,...W(a)}}),S=()=>crypto.randomUUID();export{z as c,v as f,S as g};
