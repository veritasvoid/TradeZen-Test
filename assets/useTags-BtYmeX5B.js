import{d as u,f as d,h as i,S as o,i as l}from"./index-Jll3beFS.js";import{u as g,a as c}from"./useMutation-Cuvrz-yq.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=u("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),h=e=>!e||e.length<5?null:{tagId:e[0],name:e[1],color:e[2],emoji:e[3],order:parseInt(e[4])||0},p=async()=>{const e="1ruzm5D-ofifAU7d5oRChBT7DAYFTlVLgULSsXvYEtXU";console.log("ðŸ·ï¸ Fetching tags from sheet:",e);try{const t=(await window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:e,range:`${o.TAGS}!A2:E`})).result.values||[];console.log("ðŸ“¥ Received tag rows:",t.length);const r=t.map(h).filter(Boolean);return console.log("âœ… Parsed tags:",r),r.sort((n,a)=>n.order-a.order)}catch(s){return console.error("âŒ Failed to fetch tags:",s),[]}},I=async e=>{const s=await i.getOrCreateSpreadsheet(),t=[e.tagId,e.name,e.color,e.emoji,e.order||0];return await window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:s,range:`${o.TAGS}!A:E`,valueInputOption:"USER_ENTERED",resource:{values:[t]}}),e},y=async e=>{const s=localStorage.getItem(l.SHEET_ID),n=((await window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:s,range:`${o.TAGS}!A:A`})).result.values||[]).findIndex(a=>a[0]===e);if(n===-1)throw new Error("Tag not found");await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:s,resource:{requests:[{deleteDimension:{range:{sheetId:1,dimension:"ROWS",startIndex:n,endIndex:n+1}}}]}})},S=()=>g({queryKey:["tags"],queryFn:p,staleTime:0,gcTime:0,refetchOnMount:"always"}),f=()=>{const e=d();return c({mutationFn:I,onSuccess:()=>{e.invalidateQueries({queryKey:["tags"]})}})},E=()=>{const e=d();return c({mutationFn:y,onSuccess:()=>{e.invalidateQueries({queryKey:["tags"]})}})};export{w as P,f as a,E as b,S as u};
