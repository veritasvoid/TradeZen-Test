import{b as k,r as o,j as e,L as w,d as v,i as j,k as f}from"./index-BuUkK6Xl.js";import{B as h}from"./Button-Cfe3Bw3V.js";import{u as S,P as b,a as I,S as z,T as E,b as F,c as L,M as A}from"./useTags-BvHuPGIU.js";import{g as D}from"./utils-ne7PFkbe.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=k("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),U=()=>{const{data:s=[],isLoading:d}=S(),[c,a]=o.useState(!1),[g,i]=o.useState(null),n=()=>{i(null),a(!0)},r=l=>{i(l),a(!0)},m=()=>{a(!1),i(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 pb-20 max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Strategy Tags"}),e.jsxs(h,{onClick:n,size:"sm",children:[e.jsx(b,{size:18,className:"mr-1"}),"New Tag"]})]}),d?e.jsx(w,{type:"skeleton-card"}):s.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ·ï¸"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"No strategy tags yet"}),e.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Create tags to categorize your trades by setup type"}),e.jsxs(h,{onClick:n,children:[e.jsx(b,{size:18,className:"mr-2"}),"Create Your First Tag"]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-text-tertiary text-sm",children:[s.length," tag",s.length!==1?"s":""]}),s.map(l=>e.jsx(O,{tag:l,onEdit:r},l.tagId))]})]}),c&&e.jsx(P,{tag:g,existingTags:s,onClose:m})]})},O=({tag:s,onEdit:d})=>{var r;const{showToast:c}=v(),a=I(),[g,i]=o.useState(!1),n=async()=>{if(confirm(`Delete "${s.name}" tag?`))try{i(!0),await a.mutateAsync(s.tagId),c("Tag deleted","success")}catch{c("Failed to delete tag","error")}finally{i(!1)}};return e.jsx("div",{className:"card border-l-4 hover:bg-surface-hover transition-colors",style:{borderLeftColor:s.color},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:"p-2 cursor-grab active:cursor-grabbing text-text-tertiary hover:text-text-secondary",children:e.jsx(G,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-2xl",children:s.emoji}),e.jsx("span",{className:"text-lg font-semibold",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-sm text-text-tertiary",children:((r=j.find(m=>m.value===s.color))==null?void 0:r.name)||"Custom"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>d(s),className:"text-text-secondary hover:text-accent",children:e.jsx(z,{size:18})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:n,loading:g,className:"text-text-secondary hover:text-loss",children:e.jsx(E,{size:18})})]})]})})},P=({tag:s,existingTags:d,onClose:c})=>{const{showToast:a}=v(),g=F(),i=L(),n=!!s,[r,m]=o.useState((s==null?void 0:s.name)||""),[l,N]=o.useState((s==null?void 0:s.emoji)||f[0]),[x,T]=o.useState((s==null?void 0:s.color)||j[0].value),[p,y]=o.useState(!1),C=async t=>{if(t.preventDefault(),!r.trim()){a("Please enter a tag name","error");return}if(d.find(u=>u.name.toLowerCase()===r.trim().toLowerCase()&&u.tagId!==(s==null?void 0:s.tagId))){a("A tag with this name already exists","error");return}try{if(y(!0),n)await i.mutateAsync({tagId:s.tagId,updates:{name:r.trim(),emoji:l,color:x}}),a("Tag updated","success");else{const u={tagId:D(),name:r.trim(),emoji:l,color:x,order:d.length};await g.mutateAsync(u),a("Tag created","success")}c()}catch(u){console.error("Failed to save tag:",u),a("Failed to save tag","error")}finally{y(!1)}};return e.jsx(A,{isOpen:!0,onClose:c,title:n?"Edit Tag":"Create Tag",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"card text-center py-6",style:{backgroundColor:`${x}20`,borderColor:x,borderWidth:"2px"},children:[e.jsx("div",{className:"text-4xl mb-2",children:l}),e.jsx("div",{className:"text-xl font-semibold",style:{color:x},children:r||"Tag Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tag Name"}),e.jsx("input",{type:"text",value:r,onChange:t=>m(t.target.value),className:"input",placeholder:"e.g., Break & Retest",maxLength:50,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Emoji"}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:f.map(t=>e.jsx("button",{type:"button",onClick:()=>N(t),className:`
                  text-2xl p-2 rounded-lg transition-colors
                  ${l===t?"bg-accent text-white":"bg-surface hover:bg-surface-hover"}
                `,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Color"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:j.map(t=>e.jsx("button",{type:"button",onClick:()=>T(t.value),className:`
                  p-3 rounded-lg transition-all
                  ${x===t.value?"ring-2 ring-offset-2 ring-accent scale-105":"hover:scale-105"}
                `,style:{backgroundColor:t.value},children:e.jsx("div",{className:"text-white text-xs font-medium",children:t.name})},t.value))})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:c,className:"flex-1",disabled:p,children:"Cancel"}),e.jsx(h,{type:"submit",className:"flex-1",loading:p,children:n?"Update Tag":"Create Tag"})]})]})})};export{U as default};
